{"file_contents":{"frontend/app/register.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { useAuth } from '../contexts/AuthContext';\n\nexport default function RegisterScreen() {\n  const [fullName, setFullName] = useState('');\n  const [email, setEmail] = useState('');\n  const [phone, setPhone] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const { signUp } = useAuth();\n\n  const handleRegister = async () => {\n    if (!fullName || !email || !password || !confirmPassword) {\n      Alert.alert('Error', 'Please fill in all required fields');\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      Alert.alert('Error', 'Passwords do not match');\n      return;\n    }\n\n    if (password.length < 6) {\n      Alert.alert('Error', 'Password must be at least 6 characters');\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      await signUp(email, password, fullName, phone);\n      Alert.alert('Success', 'Account created successfully!');\n      router.replace('/');\n    } catch (error: any) {\n      Alert.alert('Registration Failed', error.message || 'Could not create account');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <ScrollView style={styles.container} contentContainerStyle={styles.contentContainer}>\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>Create Account</Text>\n        <Text style={styles.headerSubtitle}>Start your loan journey with QuickLoan</Text>\n      </View>\n\n      <View style={styles.form}>\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Full Name *</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"John Doe\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={fullName}\n            onChangeText={setFullName}\n            editable={!isLoading}\n          />\n        </View>\n\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Email Address *</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"your.email@example.com\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={email}\n            onChangeText={setEmail}\n            autoCapitalize=\"none\"\n            keyboardType=\"email-address\"\n            editable={!isLoading}\n          />\n        </View>\n\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Phone Number</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"+1 (234) 567-8900\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={phone}\n            onChangeText={setPhone}\n            keyboardType=\"phone-pad\"\n            editable={!isLoading}\n          />\n        </View>\n\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Password *</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"Minimum 6 characters\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={password}\n            onChangeText={setPassword}\n            secureTextEntry\n            editable={!isLoading}\n          />\n        </View>\n\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Confirm Password *</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"Re-enter your password\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={confirmPassword}\n            onChangeText={setConfirmPassword}\n            secureTextEntry\n            editable={!isLoading}\n          />\n        </View>\n\n        <TouchableOpacity\n          style={[styles.registerButton, isLoading && styles.registerButtonDisabled]}\n          onPress={handleRegister}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator color=\"#FFFFFF\" />\n          ) : (\n            <Text style={styles.registerButtonText}>Create Account</Text>\n          )}\n        </TouchableOpacity>\n\n        <View style={styles.terms}>\n          <Text style={styles.termsText}>\n            By creating an account, you agree to our{' '}\n            <Text style={styles.termsLink}>Terms of Service</Text> and{' '}\n            <Text style={styles.termsLink}>Privacy Policy</Text>\n          </Text>\n        </View>\n\n        <View style={styles.divider}>\n          <View style={styles.dividerLine} />\n          <Text style={styles.dividerText}>OR</Text>\n          <View style={styles.dividerLine} />\n        </View>\n\n        <TouchableOpacity\n          style={styles.loginLink}\n          onPress={() => router.push('/login')}\n          disabled={isLoading}\n        >\n          <Text style={styles.loginLinkText}>\n            Already have an account? <Text style={styles.loginLinkBold}>Sign In</Text>\n          </Text>\n        </TouchableOpacity>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  contentContainer: {\n    flexGrow: 1,\n    padding: 20,\n    paddingTop: 40,\n  },\n  header: {\n    marginBottom: 32,\n    alignItems: 'center',\n  },\n  headerTitle: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 8,\n  },\n  headerSubtitle: {\n    fontSize: 16,\n    color: '#6B7280',\n    textAlign: 'center',\n  },\n  form: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 16,\n    padding: 24,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 3,\n  },\n  inputGroup: {\n    marginBottom: 16,\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#374151',\n    marginBottom: 8,\n  },\n  input: {\n    backgroundColor: '#F9FAFB',\n    borderWidth: 1,\n    borderColor: '#E5E7EB',\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 16,\n    color: '#111827',\n  },\n  registerButton: {\n    backgroundColor: '#4F46E5',\n    borderRadius: 8,\n    padding: 16,\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  registerButtonDisabled: {\n    backgroundColor: '#A5B4FC',\n  },\n  registerButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  terms: {\n    marginTop: 16,\n    alignItems: 'center',\n  },\n  termsText: {\n    fontSize: 12,\n    color: '#6B7280',\n    textAlign: 'center',\n  },\n  termsLink: {\n    color: '#4F46E5',\n    fontWeight: '600',\n  },\n  divider: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: 24,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: '#E5E7EB',\n  },\n  dividerText: {\n    marginHorizontal: 16,\n    color: '#9CA3AF',\n    fontSize: 14,\n  },\n  loginLink: {\n    alignItems: 'center',\n  },\n  loginLinkText: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  loginLinkBold: {\n    color: '#4F46E5',\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":6996},"frontend/utils/loanCalculator.ts":{"content":"import { LoanCalculation } from '../types';\n\nexport const calculateLoan = (\n  amount: number,\n  annualRate: number,\n  termMonths: number\n): LoanCalculation => {\n  const monthlyRate = annualRate / 100 / 12;\n  \n  let monthlyPayment: number;\n  if (monthlyRate === 0) {\n    monthlyPayment = amount / termMonths;\n  } else {\n    monthlyPayment =\n      (amount * monthlyRate * Math.pow(1 + monthlyRate, termMonths)) /\n      (Math.pow(1 + monthlyRate, termMonths) - 1);\n  }\n\n  const totalPayment = monthlyPayment * termMonths;\n  const totalInterest = totalPayment - amount;\n\n  return {\n    loanAmount: amount,\n    interestRate: annualRate,\n    termMonths,\n    monthlyPayment: Math.round(monthlyPayment * 100) / 100,\n    totalPayment: Math.round(totalPayment * 100) / 100,\n    totalInterest: Math.round(totalInterest * 100) / 100,\n  };\n};\n\nexport const formatCurrency = (amount: number): string => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n  }).format(amount);\n};\n","size_bytes":1001},"frontend/contexts/AuthContext.tsx":{"content":"import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { supabase } from '../lib/supabase';\nimport { Session, User } from '@supabase/supabase-js';\n\ninterface UserProfile extends User {\n  roles?: string[];\n  full_name?: string;\n  phone?: string;\n}\n\ninterface AuthContextType {\n  session: Session | null;\n  user: UserProfile | null;\n  isLoading: boolean;\n  signIn: (email: string, password: string) => Promise<void>;\n  signUp: (email: string, password: string, fullName: string, phone?: string) => Promise<void>;\n  signOut: () => Promise<void>;\n  hasRole: (role: string) => boolean;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  session: null,\n  user: null,\n  isLoading: true,\n  signIn: async () => {},\n  signUp: async () => {},\n  signOut: async () => {},\n  hasRole: () => false,\n});\n\nexport const useAuth = () => useContext(AuthContext);\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [session, setSession] = useState<Session | null>(null);\n  const [user, setUser] = useState<UserProfile | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setSession(session);\n      if (session?.user) {\n        fetchUserProfile(session.user.id);\n      } else {\n        setIsLoading(false);\n      }\n    });\n\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      setSession(session);\n      if (session?.user) {\n        fetchUserProfile(session.user.id);\n      } else {\n        setUser(null);\n        setIsLoading(false);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const fetchUserProfile = async (userId: string) => {\n    try {\n      const { data: userRoles } = await supabase\n        .from('user_roles')\n        .select('roles(name)')\n        .eq('user_id', userId);\n\n      const roles = userRoles?.map((ur: any) => ur.roles.name) || [];\n\n      const { data: userProfile } = await supabase\n        .from('users')\n        .select('*')\n        .eq('id', userId)\n        .single();\n\n      setUser({\n        ...session?.user,\n        ...userProfile,\n        roles,\n      } as UserProfile);\n    } catch (error) {\n      console.error('Error fetching user profile:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signIn = async (email: string, password: string) => {\n    const { data, error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n\n    if (error) throw error;\n    \n    setSession(data.session);\n    if (data.user) {\n      await fetchUserProfile(data.user.id);\n    }\n  };\n\n  const signUp = async (email: string, password: string, fullName: string, phone?: string) => {\n    const API_URL = process.env.EXPO_PUBLIC_API_URL || 'http://localhost:3001/api';\n    \n    const response = await fetch(`${API_URL}/auth/register`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        email,\n        password,\n        full_name: fullName,\n        phone,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Registration failed');\n    }\n\n    const data = await response.json();\n    \n    setSession(data.session);\n    if (data.user) {\n      await fetchUserProfile(data.user.id);\n    }\n  };\n\n  const signOut = async () => {\n    await supabase.auth.signOut();\n    setSession(null);\n    setUser(null);\n  };\n\n  const hasRole = (role: string) => {\n    return user?.roles?.includes(role) || false;\n  };\n\n  return (\n    <AuthContext.Provider value={{ session, user, isLoading, signIn, signUp, signOut, hasRole }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n","size_bytes":3825},"frontend/metro.config.js":{"content":"const { getDefaultConfig } = require('expo/metro-config');\n\nconst config = getDefaultConfig(__dirname);\n\nmodule.exports = config;\n","size_bytes":130},"frontend/app/admin.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  ActivityIndicator,\n  Alert,\n  RefreshControl,\n  Modal,\n  TextInput,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { api } from '../lib/api';\nimport { useAuth } from '../contexts/AuthContext';\nimport { Ionicons } from '@expo/vector-icons';\n\ninterface Loan {\n  id: string;\n  user_id: string;\n  amount: number;\n  term_months: number;\n  status: string;\n  purpose: string;\n  loan_type: string;\n  created_at: string;\n  users?: {\n    full_name: string;\n    email: string;\n  };\n}\n\ninterface Rider {\n  id: string;\n  user_id: string;\n  zone: string;\n  is_active: boolean;\n  max_assignments: number;\n  current_assignments: number;\n  users?: {\n    full_name: string;\n    email: string;\n    phone: string;\n  };\n}\n\ninterface Metrics {\n  total_loans: number;\n  pending_loans: number;\n  approved_loans: number;\n  rejected_loans: number;\n  total_disbursed: number;\n  active_riders: number;\n}\n\nexport default function AdminDashboard() {\n  const { user, hasRole } = useAuth();\n  const [activeTab, setActiveTab] = useState<'loans' | 'riders' | 'metrics'>('loans');\n  const [loans, setLoans] = useState<Loan[]>([]);\n  const [riders, setRiders] = useState<Rider[]>([]);\n  const [metrics, setMetrics] = useState<Metrics | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [selectedLoan, setSelectedLoan] = useState<Loan | null>(null);\n  const [showStatusModal, setShowStatusModal] = useState(false);\n  const [showRiderModal, setShowRiderModal] = useState(false);\n  const [newRiderEmail, setNewRiderEmail] = useState('');\n  const [newRiderZone, setNewRiderZone] = useState('');\n\n  useEffect(() => {\n    if (!hasRole('admin')) {\n      Alert.alert('Access Denied', 'You do not have admin privileges');\n      router.back();\n      return;\n    }\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      if (activeTab === 'loans') {\n        const data = await api.get('/admin/loans');\n        setLoans(data.loans || []);\n      } else if (activeTab === 'riders') {\n        const data = await api.get('/admin/riders');\n        setRiders(data.riders || []);\n      } else if (activeTab === 'metrics') {\n        const data = await api.get('/admin/metrics');\n        setMetrics(data);\n      }\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to load data');\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n\n  useEffect(() => {\n    setLoading(true);\n    loadData();\n  }, [activeTab]);\n\n  const onRefresh = async () => {\n    setRefreshing(true);\n    await loadData();\n  };\n\n  const updateLoanStatus = async (loanId: string, newStatus: string) => {\n    try {\n      await api.put(`/admin/loans/${loanId}`, { status: newStatus });\n      Alert.alert('Success', 'Loan status updated successfully');\n      setShowStatusModal(false);\n      setSelectedLoan(null);\n      loadData();\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to update loan status');\n    }\n  };\n\n  const createRider = async () => {\n    if (!newRiderEmail || !newRiderZone) {\n      Alert.alert('Error', 'Please fill in all fields');\n      return;\n    }\n\n    try {\n      await api.post('/admin/riders', {\n        email: newRiderEmail,\n        zone: newRiderZone,\n        max_assignments: 10,\n      });\n      Alert.alert('Success', 'Rider created successfully');\n      setShowRiderModal(false);\n      setNewRiderEmail('');\n      setNewRiderZone('');\n      loadData();\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to create rider');\n    }\n  };\n\n  const toggleRiderStatus = async (riderId: string, isActive: boolean) => {\n    try {\n      await api.put(`/admin/riders/${riderId}`, { is_active: !isActive });\n      Alert.alert('Success', `Rider ${!isActive ? 'activated' : 'deactivated'} successfully`);\n      loadData();\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to update rider status');\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status.toLowerCase()) {\n      case 'approved':\n      case 'disbursed':\n        return '#10B981';\n      case 'rejected':\n        return '#EF4444';\n      case 'under_review':\n        return '#F59E0B';\n      default:\n        return '#6B7280';\n    }\n  };\n\n  const renderLoanCard = (loan: Loan) => (\n    <View key={loan.id} style={styles.card}>\n      <View style={styles.cardHeader}>\n        <View style={{ flex: 1 }}>\n          <Text style={styles.cardTitle}>\n            {loan.users?.full_name || 'Unknown User'}\n          </Text>\n          <Text style={styles.cardSubtitle}>{loan.users?.email}</Text>\n        </View>\n        <View\n          style={[styles.statusBadge, { backgroundColor: getStatusColor(loan.status) }]}\n        >\n          <Text style={styles.statusText}>\n            {loan.status.replace('_', ' ').toUpperCase()}\n          </Text>\n        </View>\n      </View>\n\n      <View style={styles.cardBody}>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Amount:</Text>\n          <Text style={styles.detailValue}>${loan.amount.toLocaleString()}</Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Term:</Text>\n          <Text style={styles.detailValue}>{loan.term_months} months</Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Type:</Text>\n          <Text style={styles.detailValue}>{loan.loan_type}</Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Purpose:</Text>\n          <Text style={styles.detailValue} numberOfLines={2}>\n            {loan.purpose}\n          </Text>\n        </View>\n      </View>\n\n      <TouchableOpacity\n        style={styles.actionButton}\n        onPress={() => {\n          setSelectedLoan(loan);\n          setShowStatusModal(true);\n        }}\n      >\n        <Text style={styles.actionButtonText}>Update Status</Text>\n      </TouchableOpacity>\n    </View>\n  );\n\n  const renderRiderCard = (rider: Rider) => (\n    <View key={rider.id} style={styles.card}>\n      <View style={styles.cardHeader}>\n        <View style={{ flex: 1 }}>\n          <Text style={styles.cardTitle}>\n            {rider.users?.full_name || 'Unknown Rider'}\n          </Text>\n          <Text style={styles.cardSubtitle}>{rider.users?.email}</Text>\n        </View>\n        <View\n          style={[\n            styles.statusBadge,\n            { backgroundColor: rider.is_active ? '#10B981' : '#9CA3AF' },\n          ]}\n        >\n          <Text style={styles.statusText}>\n            {rider.is_active ? 'ACTIVE' : 'INACTIVE'}\n          </Text>\n        </View>\n      </View>\n\n      <View style={styles.cardBody}>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Zone:</Text>\n          <Text style={styles.detailValue}>{rider.zone}</Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Assignments:</Text>\n          <Text style={styles.detailValue}>\n            {rider.current_assignments || 0} / {rider.max_assignments}\n          </Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Phone:</Text>\n          <Text style={styles.detailValue}>{rider.users?.phone || 'N/A'}</Text>\n        </View>\n      </View>\n\n      <TouchableOpacity\n        style={[\n          styles.actionButton,\n          !rider.is_active && styles.actionButtonSecondary,\n        ]}\n        onPress={() => toggleRiderStatus(rider.id, rider.is_active)}\n      >\n        <Text\n          style={[\n            styles.actionButtonText,\n            !rider.is_active && styles.actionButtonTextSecondary,\n          ]}\n        >\n          {rider.is_active ? 'Deactivate' : 'Activate'}\n        </Text>\n      </TouchableOpacity>\n    </View>\n  );\n\n  const renderMetrics = () => {\n    if (!metrics) return null;\n\n    return (\n      <View style={styles.metricsContainer}>\n        <View style={styles.metricCard}>\n          <Text style={styles.metricValue}>{metrics.total_loans}</Text>\n          <Text style={styles.metricLabel}>Total Loans</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={[styles.metricValue, { color: '#F59E0B' }]}>\n            {metrics.pending_loans}\n          </Text>\n          <Text style={styles.metricLabel}>Pending</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={[styles.metricValue, { color: '#10B981' }]}>\n            {metrics.approved_loans}\n          </Text>\n          <Text style={styles.metricLabel}>Approved</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={[styles.metricValue, { color: '#EF4444' }]}>\n            {metrics.rejected_loans}\n          </Text>\n          <Text style={styles.metricLabel}>Rejected</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={styles.metricValue}>\n            ${(metrics.total_disbursed || 0).toLocaleString()}\n          </Text>\n          <Text style={styles.metricLabel}>Total Disbursed</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={styles.metricValue}>{metrics.active_riders}</Text>\n          <Text style={styles.metricLabel}>Active Riders</Text>\n        </View>\n      </View>\n    );\n  };\n\n  if (!hasRole('admin')) {\n    return null;\n  }\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>\n          <Ionicons name=\"arrow-back\" size={24} color=\"#FFFFFF\" />\n        </TouchableOpacity>\n        <Text style={styles.headerTitle}>Admin Dashboard</Text>\n      </View>\n\n      <View style={styles.tabBar}>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'loans' && styles.tabActive]}\n          onPress={() => setActiveTab('loans')}\n        >\n          <Text\n            style={[styles.tabText, activeTab === 'loans' && styles.tabTextActive]}\n          >\n            Loans\n          </Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'riders' && styles.tabActive]}\n          onPress={() => setActiveTab('riders')}\n        >\n          <Text\n            style={[styles.tabText, activeTab === 'riders' && styles.tabTextActive]}\n          >\n            Riders\n          </Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'metrics' && styles.tabActive]}\n          onPress={() => setActiveTab('metrics')}\n        >\n          <Text\n            style={[styles.tabText, activeTab === 'metrics' && styles.tabTextActive]}\n          >\n            Metrics\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {loading ? (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color=\"#4F46E5\" />\n        </View>\n      ) : (\n        <ScrollView\n          style={styles.content}\n          refreshControl={\n            <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n          }\n        >\n          {activeTab === 'loans' && (\n            <>\n              {loans.length === 0 ? (\n                <View style={styles.emptyState}>\n                  <Text style={styles.emptyText}>No loans found</Text>\n                </View>\n              ) : (\n                loans.map(renderLoanCard)\n              )}\n            </>\n          )}\n\n          {activeTab === 'riders' && (\n            <>\n              <TouchableOpacity\n                style={styles.createButton}\n                onPress={() => setShowRiderModal(true)}\n              >\n                <Ionicons name=\"add-circle\" size={24} color=\"#FFFFFF\" />\n                <Text style={styles.createButtonText}>Create New Rider</Text>\n              </TouchableOpacity>\n              {riders.length === 0 ? (\n                <View style={styles.emptyState}>\n                  <Text style={styles.emptyText}>No riders found</Text>\n                </View>\n              ) : (\n                riders.map(renderRiderCard)\n              )}\n            </>\n          )}\n\n          {activeTab === 'metrics' && renderMetrics()}\n        </ScrollView>\n      )}\n\n      <Modal\n        visible={showStatusModal}\n        transparent\n        animationType=\"slide\"\n        onRequestClose={() => setShowStatusModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <Text style={styles.modalTitle}>Update Loan Status</Text>\n            <Text style={styles.modalSubtitle}>\n              Loan Amount: ${selectedLoan?.amount.toLocaleString()}\n            </Text>\n\n            <TouchableOpacity\n              style={styles.statusOption}\n              onPress={() => updateLoanStatus(selectedLoan!.id, 'under_review')}\n            >\n              <Text style={styles.statusOptionText}>Under Review</Text>\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={styles.statusOption}\n              onPress={() => updateLoanStatus(selectedLoan!.id, 'approved')}\n            >\n              <Text style={styles.statusOptionText}>Approve</Text>\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={styles.statusOption}\n              onPress={() => updateLoanStatus(selectedLoan!.id, 'rejected')}\n            >\n              <Text style={styles.statusOptionText}>Reject</Text>\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={styles.cancelButton}\n              onPress={() => setShowStatusModal(false)}\n            >\n              <Text style={styles.cancelButtonText}>Cancel</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </Modal>\n\n      <Modal\n        visible={showRiderModal}\n        transparent\n        animationType=\"slide\"\n        onRequestClose={() => setShowRiderModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <Text style={styles.modalTitle}>Create New Rider</Text>\n\n            <TextInput\n              style={styles.input}\n              placeholder=\"Email Address\"\n              value={newRiderEmail}\n              onChangeText={setNewRiderEmail}\n              autoCapitalize=\"none\"\n              keyboardType=\"email-address\"\n            />\n\n            <TextInput\n              style={styles.input}\n              placeholder=\"Zone (e.g., North, South, East, West)\"\n              value={newRiderZone}\n              onChangeText={setNewRiderZone}\n            />\n\n            <TouchableOpacity style={styles.submitButton} onPress={createRider}>\n              <Text style={styles.submitButtonText}>Create Rider</Text>\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={styles.cancelButton}\n              onPress={() => setShowRiderModal(false)}\n            >\n              <Text style={styles.cancelButtonText}>Cancel</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  header: {\n    backgroundColor: '#4F46E5',\n    padding: 20,\n    paddingTop: 40,\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  backButton: {\n    marginRight: 16,\n  },\n  headerTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#FFFFFF',\n  },\n  tabBar: {\n    flexDirection: 'row',\n    backgroundColor: '#FFFFFF',\n    borderBottomWidth: 1,\n    borderBottomColor: '#E5E7EB',\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: 16,\n    alignItems: 'center',\n  },\n  tabActive: {\n    borderBottomWidth: 3,\n    borderBottomColor: '#4F46E5',\n  },\n  tabText: {\n    fontSize: 16,\n    color: '#6B7280',\n    fontWeight: '600',\n  },\n  tabTextActive: {\n    color: '#4F46E5',\n  },\n  content: {\n    flex: 1,\n    padding: 16,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  card: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 12,\n    marginBottom: 16,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  cardHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#F3F4F6',\n  },\n  cardTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#111827',\n  },\n  cardSubtitle: {\n    fontSize: 14,\n    color: '#6B7280',\n    marginTop: 4,\n  },\n  statusBadge: {\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 16,\n  },\n  statusText: {\n    color: '#FFFFFF',\n    fontSize: 12,\n    fontWeight: 'bold',\n  },\n  cardBody: {\n    padding: 16,\n  },\n  detailRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 8,\n  },\n  detailLabel: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  detailValue: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#111827',\n    flex: 1,\n    textAlign: 'right',\n  },\n  actionButton: {\n    backgroundColor: '#4F46E5',\n    padding: 16,\n    borderBottomLeftRadius: 12,\n    borderBottomRightRadius: 12,\n    alignItems: 'center',\n  },\n  actionButtonSecondary: {\n    backgroundColor: '#FFFFFF',\n    borderTopWidth: 1,\n    borderTopColor: '#E5E7EB',\n  },\n  actionButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  actionButtonTextSecondary: {\n    color: '#4F46E5',\n  },\n  createButton: {\n    backgroundColor: '#10B981',\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 16,\n    gap: 8,\n  },\n  createButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  emptyState: {\n    padding: 40,\n    alignItems: 'center',\n  },\n  emptyText: {\n    fontSize: 16,\n    color: '#9CA3AF',\n  },\n  metricsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 16,\n  },\n  metricCard: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 12,\n    padding: 20,\n    width: '47%',\n    alignItems: 'center',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  metricValue: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    color: '#4F46E5',\n    marginBottom: 8,\n  },\n  metricLabel: {\n    fontSize: 14,\n    color: '#6B7280',\n    textAlign: 'center',\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20,\n  },\n  modalContent: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 16,\n    padding: 24,\n    width: '100%',\n    maxWidth: 400,\n  },\n  modalTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 8,\n  },\n  modalSubtitle: {\n    fontSize: 14,\n    color: '#6B7280',\n    marginBottom: 24,\n  },\n  statusOption: {\n    backgroundColor: '#F3F4F6',\n    padding: 16,\n    borderRadius: 8,\n    marginBottom: 12,\n    alignItems: 'center',\n  },\n  statusOptionText: {\n    fontSize: 16,\n    fontWeight: '600',\n    color: '#111827',\n  },\n  input: {\n    backgroundColor: '#F9FAFB',\n    borderWidth: 1,\n    borderColor: '#E5E7EB',\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 16,\n    marginBottom: 16,\n  },\n  submitButton: {\n    backgroundColor: '#4F46E5',\n    padding: 16,\n    borderRadius: 8,\n    alignItems: 'center',\n    marginBottom: 12,\n  },\n  submitButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  cancelButton: {\n    padding: 16,\n    alignItems: 'center',\n  },\n  cancelButtonText: {\n    color: '#6B7280',\n    fontSize: 16,\n    fontWeight: '600',\n  },\n});\n","size_bytes":19967},"backend/src/config/supabase.ts":{"content":"import { createClient } from '@supabase/supabase-js';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nconst supabaseUrl = process.env.SUPABASE_URL;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY;\n\nif (!supabaseUrl || !supabaseServiceKey) {\n  console.error('\\n❌ SUPABASE CREDENTIALS MISSING ❌');\n  console.error('═════════════════════════════════════════════════════════════');\n  console.error('The backend requires Supabase credentials to function.');\n  console.error('');\n  console.error('Please add these secrets in Replit:');\n  console.error('  1. SUPABASE_URL');\n  console.error('  2. SUPABASE_SERVICE_KEY');\n  console.error('  3. SUPABASE_ANON_KEY');\n  console.error('');\n  console.error('Get your credentials from: https://supabase.com');\n  console.error('Go to Settings → API in your Supabase project');\n  console.error('═════════════════════════════════════════════════════════════\\n');\n  throw new Error('Missing Supabase environment variables');\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseServiceKey, {\n  auth: {\n    autoRefreshToken: false,\n    persistSession: false\n  }\n});\n\nexport default supabase;\n","size_bytes":1393},"backend/src/controllers/riderController.ts":{"content":"import { Response } from 'express';\nimport { supabase } from '../config/supabase';\nimport { AppError } from '../middleware/errorHandler';\nimport { AuthRequest } from '../middleware/auth';\n\nexport const getAssignments = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { data: rider } = await supabase\n      .from('riders')\n      .select('id')\n      .eq('user_id', req.user.id)\n      .single();\n\n    if (!rider) {\n      throw new AppError('Rider profile not found', 404);\n    }\n\n    const { data, error } = await supabase\n      .from('rider_assignments')\n      .select(`\n        *,\n        loan:loans(\n          *,\n          borrower:users!loans_borrower_id_fkey(full_name, phone, email)\n        )\n      `)\n      .eq('rider_id', rider.id)\n      .order('assigned_at', { ascending: false });\n\n    if (error) {\n      throw new AppError('Failed to fetch assignments', 500);\n    }\n\n    res.json({ assignments: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Get assignments error:', error);\n      res.status(500).json({ error: 'Failed to fetch assignments' });\n    }\n  }\n};\n\nexport const updateAssignmentStatus = async (req: AuthRequest, res: Response) => {\n  try {\n    const { id } = req.params;\n    const { status, notes } = req.body;\n\n    const { data, error } = await supabase\n      .from('rider_assignments')\n      .update({\n        status,\n        notes,\n        ...(status === 'completed' && { completed_at: new Date().toISOString() }),\n      })\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to update assignment', 500);\n    }\n\n    res.json({ message: 'Assignment updated', assignment: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Update assignment error:', error);\n      res.status(500).json({ error: 'Failed to update assignment' });\n    }\n  }\n};\n\nexport const updateAvailability = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { status } = req.body;\n\n    const { data, error } = await supabase\n      .from('riders')\n      .update({ status })\n      .eq('user_id', req.user.id)\n      .select()\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to update availability', 500);\n    }\n\n    res.json({ message: 'Availability updated', rider: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Update availability error:', error);\n      res.status(500).json({ error: 'Failed to update availability' });\n    }\n  }\n};\n\nexport const getMetrics = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { data: rider } = await supabase\n      .from('riders')\n      .select('*')\n      .eq('user_id', req.user.id)\n      .single();\n\n    if (!rider) {\n      throw new AppError('Rider profile not found', 404);\n    }\n\n    const { data: assignments } = await supabase\n      .from('rider_assignments')\n      .select('status')\n      .eq('rider_id', rider.id);\n\n    const metrics = {\n      current_assignments: rider.current_assignments,\n      total_completed: rider.total_completed,\n      rating: rider.rating,\n      pending_assignments: assignments?.filter(a => a.status === 'assigned' || a.status === 'in_progress').length || 0,\n    };\n\n    res.json({ metrics });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Get rider metrics error:', error);\n      res.status(500).json({ error: 'Failed to fetch metrics' });\n    }\n  }\n};\n","size_bytes":4032},"backend/src/controllers/loanController.ts":{"content":"import { Response } from 'express';\nimport { supabase } from '../config/supabase';\nimport { AppError } from '../middleware/errorHandler';\nimport { AuthRequest } from '../middleware/auth';\n\nexport const createLoan = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { product_type, amount, term_months, purpose, interest_rate } = req.body;\n\n    if (!product_type || !amount || !term_months || !interest_rate) {\n      throw new AppError('Missing required fields', 400);\n    }\n\n    const monthly_payment = (amount * (interest_rate / 100 / 12) * Math.pow(1 + (interest_rate / 100 / 12), term_months)) / \n                           (Math.pow(1 + (interest_rate / 100 / 12), term_months) - 1);\n    \n    const total_repayment = monthly_payment * term_months;\n\n    const { data, error } = await supabase\n      .from('loans')\n      .insert([\n        {\n          borrower_id: req.user.id,\n          product_type,\n          amount,\n          term_months,\n          interest_rate,\n          purpose: purpose || null,\n          monthly_payment,\n          total_repayment,\n          status: 'pending',\n        }\n      ])\n      .select()\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to create loan application', 500);\n    }\n\n    await supabase.from('notifications').insert([\n      {\n        user_id: req.user.id,\n        type: 'loan_status',\n        title: 'Loan Application Submitted',\n        message: `Your ${product_type} loan application for $${amount} has been submitted successfully.`,\n        related_loan_id: data.id,\n      }\n    ]);\n\n    res.status(201).json({\n      message: 'Loan application created successfully',\n      loan: data,\n    });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Create loan error:', error);\n      res.status(500).json({ error: 'Failed to create loan' });\n    }\n  }\n};\n\nexport const getLoans = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { status } = req.query;\n\n    let query = supabase\n      .from('loans')\n      .select('*, rider:riders(id, user:users(full_name))')\n      .eq('borrower_id', req.user.id)\n      .order('applied_at', { ascending: false });\n\n    if (status) {\n      query = query.eq('status', status);\n    }\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new AppError('Failed to fetch loans', 500);\n    }\n\n    res.json({ loans: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Get loans error:', error);\n      res.status(500).json({ error: 'Failed to fetch loans' });\n    }\n  }\n};\n\nexport const getLoanById = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { id } = req.params;\n\n    const { data, error } = await supabase\n      .from('loans')\n      .select(`\n        *,\n        rider:riders(id, user:users(full_name, phone)),\n        documents:loan_documents(*),\n        status_history:loan_status_history(*)\n      `)\n      .eq('id', id)\n      .eq('borrower_id', req.user.id)\n      .single();\n\n    if (error || !data) {\n      throw new AppError('Loan not found', 404);\n    }\n\n    res.json({ loan: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Get loan error:', error);\n      res.status(500).json({ error: 'Failed to fetch loan' });\n    }\n  }\n};\n\nexport const uploadLoanDocument = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { id } = req.params;\n    const { file_name, storage_path, document_type } = req.body;\n\n    if (!file_name || !storage_path || !document_type) {\n      throw new AppError('Missing required fields', 400);\n    }\n\n    const { data: loan } = await supabase\n      .from('loans')\n      .select('id')\n      .eq('id', id)\n      .eq('borrower_id', req.user.id)\n      .single();\n\n    if (!loan) {\n      throw new AppError('Loan not found', 404);\n    }\n\n    const { data, error } = await supabase\n      .from('loan_documents')\n      .insert([\n        {\n          loan_id: id,\n          file_name,\n          storage_path,\n          document_type,\n          uploaded_by: req.user.id,\n        }\n      ])\n      .select()\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to upload document', 500);\n    }\n\n    res.status(201).json({\n      message: 'Document uploaded successfully',\n      document: data,\n    });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Upload document error:', error);\n      res.status(500).json({ error: 'Failed to upload document' });\n    }\n  }\n};\n","size_bytes":5130},"FEATURES.md":{"content":"# QuickLoan - Complete Feature List\n\n## Main Features\n\n### 1. Multi-Role Authentication System\n- Email/password authentication via Supabase Auth\n- Role-based access control (RBAC)\n- Automatic role-based navigation after login\n- Secure JWT token management\n\n### 2. Borrower Portal\n- Loan application and management\n- Document upload and tracking\n- Real-time loan status updates\n- Loan calculator\n- Notification center\n\n### 3. Admin Dashboard\n- Complete loan oversight and management\n- Rider management system\n- Analytics and metrics\n- User management\n- System-wide controls\n\n### 4. Rider Application\n- Assigned loan queue\n- Field visit tracking\n- Status update capabilities\n- Availability management\n- Performance metrics\n\n---\n\n## Detailed Features by Role\n\n## BORROWER Features\n\n### Authentication & Profile\n- **Sign Up**\n  - Email/password registration\n  - Phone number collection\n  - Initial profile creation\n  - Automatic borrower role assignment\n  \n- **Login**\n  - Secure email/password login\n  - Remember me functionality\n  - Password reset via email\n  \n- **Profile Management**\n  - View and edit personal information\n  - Update contact details\n  - Upload profile picture\n  - Employment information management\n  - Address details\n\n### Loan Application\n- **Browse Loan Products**\n  - Personal Loan (up to $50,000 @ 8.5% APR)\n  - Business Loan (up to $500,000 @ 6.5% APR)\n  - Education Loan (up to $100,000 @ 4.5% APR)\n  - View loan details and terms\n  - Compare interest rates\n  \n- **Loan Calculator**\n  - Input loan amount\n  - Select loan term (months)\n  - View monthly payment\n  - See total interest\n  - View repayment schedule\n  - Download calculation results\n  \n- **Submit Application**\n  - Select loan product\n  - Enter loan amount and term\n  - Specify loan purpose\n  - Submit employment information\n  - Upload required documents\n  - Review and submit\n  \n- **Document Upload**\n  - ID proof (Driver's license, Passport)\n  - Income proof (Pay stubs, Tax returns)\n  - Address proof (Utility bills)\n  - Bank statements\n  - Other supporting documents\n  - Progress tracking for each document\n\n### Loan Management\n- **View All Loans**\n  - List of all loan applications\n  - Filter by status (pending, approved, rejected, etc.)\n  - Sort by date, amount\n  - Quick status overview\n  \n- **Loan Details**\n  - Complete application information\n  - Current status and timeline\n  - Assigned rider information (if any)\n  - Document list\n  - Status history\n  - Admin notes and feedback\n  \n- **Track Application Status**\n  - Real-time status updates\n  - Status timeline view\n  - Pending → Reviewing → Approved/Rejected → Disbursed\n  - Estimated decision timeline\n  \n- **Active Loan Management** (Post-approval)\n  - View remaining balance\n  - Payment schedule\n  - Make payment (future feature)\n  - Payment history\n  - Download statements\n\n### Notifications\n- **In-App Notifications**\n  - Loan status changes\n  - Document requirements\n  - Rider assignments\n  - Payment reminders\n  - System announcements\n  \n- **Push Notifications** (future)\n  - Critical updates\n  - Payment due dates\n  - Application milestones\n\n---\n\n## ADMIN Features\n\n### Dashboard & Analytics\n- **Overview Dashboard**\n  - Total loans (by status)\n  - Total disbursed amount\n  - Active riders count\n  - Recent applications\n  - System health metrics\n  \n- **Analytics**\n  - Loan approval rates\n  - Average processing time\n  - Disbursement trends\n  - Default rates\n  - Rider performance metrics\n  - Revenue analytics\n  \n- **Reports**\n  - Generate custom reports\n  - Export to PDF/Excel\n  - Scheduled reports\n  - Historical data analysis\n\n### Loan Management\n- **Loan Queue**\n  - View all pending applications\n  - Priority sorting\n  - Quick filters (status, amount, date)\n  - Bulk actions\n  - Assignment management\n  \n- **Review Applications**\n  - Detailed application view\n  - Review borrower profile\n  - View all submitted documents\n  - Check credit information\n  - View status history\n  \n- **Decision Making**\n  - Approve loans\n  - Reject with reason\n  - Request additional documents\n  - Set custom terms\n  - Add internal notes\n  \n- **Rider Assignment**\n  - View available riders\n  - Auto-assignment based on zone\n  - Manual rider selection\n  - Reassignment capability\n  - Load balancing\n  \n- **Loan Tracking**\n  - Monitor all active loans\n  - Track disbursements\n  - View payment status\n  - Handle defaults\n  - Close completed loans\n\n### Rider Management\n- **Rider Directory**\n  - List all riders\n  - View rider profiles\n  - Filter by status/zone\n  - Search functionality\n  \n- **Create/Invite Riders**\n  - Send invitation emails\n  - Set initial credentials\n  - Assign zones\n  - Set maximum assignments\n  \n- **Edit Rider Information**\n  - Update personal details\n  - Change assigned zone\n  - Adjust assignment limits\n  - Update contact information\n  \n- **Rider Status Management**\n  - Activate/deactivate riders\n  - Set on leave\n  - Suspend riders\n  - Performance monitoring\n  \n- **Assignment Management**\n  - View rider workload\n  - Reassign loans\n  - Balance assignments\n  - Track completion rates\n\n### User Management\n- **View All Users**\n  - List borrowers, admins, riders\n  - User search\n  - Filter by role\n  - Activity tracking\n  \n- **Role Management**\n  - Assign/remove roles\n  - Create custom roles (future)\n  - Permission management\n  - Role history tracking\n  \n- **User Actions**\n  - Suspend accounts\n  - Reset passwords\n  - View user activity\n  - Handle disputes\n\n### System Configuration\n- **Loan Product Settings**\n  - Edit interest rates\n  - Update loan limits\n  - Modify terms\n  - Enable/disable products\n  \n- **System Settings**\n  - Configure notifications\n  - Set approval workflows\n  - Update business rules\n  - Manage document requirements\n  \n- **Audit Logs**\n  - View all system actions\n  - Track admin activities\n  - Monitor security events\n  - Export audit trails\n\n---\n\n## RIDER Features\n\n### Assignment Management\n- **View Assigned Loans**\n  - List of assigned loans\n  - Priority indicator\n  - Customer contact info\n  - Loan details\n  - Assignment date\n  \n- **Accept/Decline Assignments**\n  - Review assignment details\n  - Accept to confirm\n  - Decline with reason\n  - Request reassignment\n  \n- **Task Queue**\n  - Pending visits\n  - In-progress tasks\n  - Completed tasks\n  - Overdue alerts\n\n### Field Operations\n- **Customer Visit Tracking**\n  - Mark visit start/end\n  - GPS location tracking\n  - Customer verification\n  - Document collection\n  \n- **Status Updates**\n  - Update loan verification status\n  - Add visit notes\n  - Upload photos\n  - Mark milestones\n  \n- **Document Collection**\n  - Capture documents on-site\n  - Upload to system\n  - Verify document authenticity\n  - Tag document types\n\n### Communication\n- **Contact Customers**\n  - View customer details\n  - Call customer (in-app dialer)\n  - Send SMS\n  - Email customer\n  \n- **Admin Communication**\n  - Report issues\n  - Request guidance\n  - Update availability\n  - Emergency escalation\n\n### Performance & Metrics\n- **Personal Dashboard**\n  - Current assignments\n  - Completed loans\n  - Performance rating\n  - Earnings (future)\n  \n- **Availability Management**\n  - Set available hours\n  - Mark on leave\n  - Update working zones\n  - Manage capacity\n  \n- **Performance Metrics**\n  - Completion rate\n  - Average processing time\n  - Customer satisfaction\n  - Quality score\n\n---\n\n## Technical Features\n\n### Security\n- Row Level Security (RLS) via Supabase\n- JWT-based authentication\n- Secure password hashing (bcrypt)\n- API rate limiting\n- Input validation and sanitization\n- CORS protection\n- SQL injection prevention\n- XSS protection\n\n### API Features\n- RESTful API architecture\n- Consistent error handling\n- Request/response validation (Zod)\n- Pagination support\n- Filtering and sorting\n- API documentation (future: Swagger)\n- Health check endpoints\n- Versioned endpoints\n\n### Data Management\n- PostgreSQL database via Supabase\n- Automatic backups\n- Data encryption at rest\n- Point-in-time recovery\n- Database migration system\n- Audit trail for all changes\n\n### File Storage\n- Supabase Storage integration\n- Secure file uploads\n- File type validation\n- Size limits enforcement\n- CDN delivery (future)\n- Automatic image optimization\n\n### Performance\n- Query optimization with indices\n- Database connection pooling\n- Response caching\n- Lazy loading\n- Code splitting (frontend)\n- Asset optimization\n\n### Monitoring & Logging\n- Error tracking\n- Performance monitoring\n- User activity logs\n- API usage metrics\n- System health monitoring\n- Automated alerts\n\n---\n\n## Future Enhancements\n\n### Phase 2\n- Payment gateway integration\n- Automated payment processing\n- SMS notifications\n- Email notifications\n- Biometric authentication\n- Credit score integration\n\n### Phase 3\n- AI-powered loan approval\n- Chatbot support\n- Video KYC\n- E-signatures\n- Mobile app (iOS/Android native)\n- Offline mode\n\n### Phase 4\n- P2P lending marketplace\n- Investment platform\n- Insurance products\n- Referral program\n- Loyalty rewards\n- Multi-language support\n\n---\n\n## Environment Setup Guide\n\n### Prerequisites\n- Node.js 20+\n- npm or yarn\n- Supabase account\n- Git\n\n### Backend Setup\n1. Navigate to backend directory: `cd backend`\n2. Install dependencies: `npm install`\n3. Copy `.env.example` to `.env`\n4. Add Supabase credentials:\n   - SUPABASE_URL\n   - SUPABASE_SERVICE_KEY\n   - JWT_SECRET\n5. Run backend: `npm run dev`\n\n### Frontend Setup\n1. Navigate to frontend directory: `cd frontend`\n2. Install dependencies: `npm install`\n3. Copy `.env.example` to `.env`\n4. Add Supabase credentials:\n   - EXPO_PUBLIC_SUPABASE_URL\n   - EXPO_PUBLIC_SUPABASE_ANON_KEY\n5. Run frontend: `npm run web`\n\n### Database Setup\n1. Create Supabase project\n2. Copy contents of `schema.sql`\n3. Run in Supabase SQL editor\n4. Create admin user manually in Authentication\n5. Assign admin role using provided SQL query\n\n---\n\n## API Endpoints Summary\n\n### Authentication\n- POST `/api/auth/register` - Register new user\n- POST `/api/auth/login` - Login user\n- POST `/api/auth/logout` - Logout user\n- POST `/api/auth/refresh` - Refresh token\n- POST `/api/auth/forgot-password` - Request password reset\n- POST `/api/auth/reset-password` - Reset password\n\n### User Profile\n- GET `/api/users/me` - Get current user profile\n- PUT `/api/users/me` - Update current user profile\n- GET `/api/users/:id` - Get user by ID (admin)\n\n### Borrower Routes\n- GET `/api/loans` - Get all loans for current user\n- POST `/api/loans` - Create new loan application\n- GET `/api/loans/:id` - Get loan details\n- POST `/api/loans/:id/documents` - Upload loan documents\n- GET `/api/loans/:id/status-history` - Get loan status history\n\n### Admin Routes\n- GET `/api/admin/loans` - Get all loans (filterable)\n- PUT `/api/admin/loans/:id` - Update loan status\n- POST `/api/admin/loans/:id/assign` - Assign rider to loan\n- GET `/api/admin/riders` - Get all riders\n- POST `/api/admin/riders` - Create/invite new rider\n- PUT `/api/admin/riders/:id` - Update rider\n- DELETE `/api/admin/riders/:id` - Deactivate rider\n- GET `/api/admin/metrics` - Get system metrics\n- GET `/api/admin/users` - Get all users\n\n### Rider Routes\n- GET `/api/rider/assignments` - Get assigned loans\n- PUT `/api/rider/assignments/:id/status` - Update assignment status\n- POST `/api/rider/assignments/:id/notes` - Add notes\n- PUT `/api/rider/availability` - Update availability\n- GET `/api/rider/metrics` - Get personal metrics\n\n### Notifications\n- GET `/api/notifications` - Get user notifications\n- PUT `/api/notifications/:id/read` - Mark as read\n- PUT `/api/notifications/read-all` - Mark all as read\n\n---\n\n## Testing Guide\n\n### Manual Testing Accounts\n- **Admin**: kcbiron79@gmail.com / almonte17\n- **Borrower**: (create via sign up)\n- **Rider**: (create via admin panel)\n\n### Test Scenarios\n1. Complete loan application flow\n2. Admin loan review and approval\n3. Rider assignment and task completion\n4. Document upload and verification\n5. Status tracking across all roles\n6. Notification delivery\n7. Role-based access control\n\n---\n\n## Support & Documentation\n- Technical documentation in `/docs`\n- API documentation (future)\n- User guides by role\n- Video tutorials (future)\n- FAQ section (future)\n","size_bytes":12122},"frontend/app/calculator.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TextInput,\n  ScrollView,\n  TouchableOpacity,\n} from 'react-native';\nimport { calculateLoan, formatCurrency } from '../utils/loanCalculator';\nimport { LineChart } from 'react-native-chart-kit';\nimport { Dimensions } from 'react-native';\n\nconst screenWidth = Dimensions.get('window').width;\n\nexport default function CalculatorScreen() {\n  const [amount, setAmount] = useState('10000');\n  const [rate, setRate] = useState('8.5');\n  const [term, setTerm] = useState('24');\n\n  const calculation = calculateLoan(\n    parseFloat(amount) || 0,\n    parseFloat(rate) || 0,\n    parseInt(term) || 1\n  );\n\n  const monthlyData = [];\n  let balance = calculation.loanAmount;\n  const monthlyRate = calculation.interestRate / 100 / 12;\n  \n  for (let i = 0; i <= Math.min(12, calculation.termMonths); i++) {\n    monthlyData.push(balance);\n    if (i < calculation.termMonths) {\n      const interest = balance * monthlyRate;\n      const principal = calculation.monthlyPayment - interest;\n      balance = Math.max(0, balance - principal);\n    }\n  }\n\n  return (\n    <ScrollView style={styles.container}>\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>Loan Calculator</Text>\n        <Text style={styles.headerSubtitle}>\n          See how much you'll pay monthly\n        </Text>\n      </View>\n\n      <View style={styles.inputSection}>\n        <View style={styles.inputContainer}>\n          <Text style={styles.inputLabel}>Loan Amount</Text>\n          <View style={styles.inputWrapper}>\n            <Text style={styles.currencySymbol}>$</Text>\n            <TextInput\n              style={styles.input}\n              value={amount}\n              onChangeText={setAmount}\n              keyboardType=\"numeric\"\n              placeholder=\"10000\"\n            />\n          </View>\n        </View>\n\n        <View style={styles.inputContainer}>\n          <Text style={styles.inputLabel}>Interest Rate (APR)</Text>\n          <View style={styles.inputWrapper}>\n            <TextInput\n              style={styles.input}\n              value={rate}\n              onChangeText={setRate}\n              keyboardType=\"numeric\"\n              placeholder=\"8.5\"\n            />\n            <Text style={styles.percentSymbol}>%</Text>\n          </View>\n        </View>\n\n        <View style={styles.inputContainer}>\n          <Text style={styles.inputLabel}>Loan Term (Months)</Text>\n          <TextInput\n            style={styles.inputFull}\n            value={term}\n            onChangeText={setTerm}\n            keyboardType=\"numeric\"\n            placeholder=\"24\"\n          />\n        </View>\n      </View>\n\n      <View style={styles.resultSection}>\n        <Text style={styles.resultTitle}>Monthly Payment</Text>\n        <Text style={styles.resultAmount}>\n          {formatCurrency(calculation.monthlyPayment)}\n        </Text>\n\n        <View style={styles.detailsContainer}>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Total Payment</Text>\n            <Text style={styles.detailValue}>\n              {formatCurrency(calculation.totalPayment)}\n            </Text>\n          </View>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Total Interest</Text>\n            <Text style={styles.detailValue}>\n              {formatCurrency(calculation.totalInterest)}\n            </Text>\n          </View>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Principal Amount</Text>\n            <Text style={styles.detailValue}>\n              {formatCurrency(calculation.loanAmount)}\n            </Text>\n          </View>\n        </View>\n      </View>\n\n      <View style={styles.chartSection}>\n        <Text style={styles.chartTitle}>Loan Balance Over Time</Text>\n        <LineChart\n          data={{\n            labels: ['Start', '', '', '', '', '', '', '', '', '', '', 'End'],\n            datasets: [\n              {\n                data: monthlyData,\n              },\n            ],\n          }}\n          width={screenWidth - 32}\n          height={220}\n          chartConfig={{\n            backgroundColor: '#4F46E5',\n            backgroundGradientFrom: '#4F46E5',\n            backgroundGradientTo: '#6366F1',\n            decimalPlaces: 0,\n            color: (opacity = 1) => `rgba(255, 255, 255, ${opacity})`,\n            style: {\n              borderRadius: 16,\n            },\n          }}\n          bezier\n          style={styles.chart}\n        />\n      </View>\n\n      <TouchableOpacity style={styles.applyButton}>\n        <Text style={styles.applyButtonText}>Apply for This Loan</Text>\n      </TouchableOpacity>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  header: {\n    backgroundColor: '#4F46E5',\n    padding: 24,\n    paddingTop: 32,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#FFFFFF',\n    marginBottom: 8,\n  },\n  headerSubtitle: {\n    fontSize: 16,\n    color: '#E0E7FF',\n  },\n  inputSection: {\n    backgroundColor: '#FFFFFF',\n    marginHorizontal: 16,\n    marginTop: -20,\n    padding: 20,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  inputContainer: {\n    marginBottom: 20,\n  },\n  inputLabel: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#374151',\n    marginBottom: 8,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: '#F9FAFB',\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: '#D1D5DB',\n    paddingHorizontal: 12,\n  },\n  currencySymbol: {\n    fontSize: 18,\n    fontWeight: '600',\n    color: '#6B7280',\n    marginRight: 4,\n  },\n  percentSymbol: {\n    fontSize: 18,\n    fontWeight: '600',\n    color: '#6B7280',\n    marginLeft: 4,\n  },\n  input: {\n    flex: 1,\n    paddingVertical: 12,\n    fontSize: 16,\n    color: '#111827',\n  },\n  inputFull: {\n    backgroundColor: '#F9FAFB',\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: '#D1D5DB',\n    paddingHorizontal: 12,\n    paddingVertical: 12,\n    fontSize: 16,\n    color: '#111827',\n  },\n  resultSection: {\n    backgroundColor: '#FFFFFF',\n    marginHorizontal: 16,\n    marginTop: 16,\n    padding: 20,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  resultTitle: {\n    fontSize: 16,\n    color: '#6B7280',\n    textAlign: 'center',\n  },\n  resultAmount: {\n    fontSize: 36,\n    fontWeight: 'bold',\n    color: '#4F46E5',\n    textAlign: 'center',\n    marginTop: 8,\n    marginBottom: 20,\n  },\n  detailsContainer: {\n    borderTopWidth: 1,\n    borderTopColor: '#E5E7EB',\n    paddingTop: 16,\n  },\n  detailRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 12,\n  },\n  detailLabel: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  detailValue: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#111827',\n  },\n  chartSection: {\n    backgroundColor: '#FFFFFF',\n    marginHorizontal: 16,\n    marginTop: 16,\n    padding: 16,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  chartTitle: {\n    fontSize: 16,\n    fontWeight: '600',\n    color: '#111827',\n    marginBottom: 16,\n  },\n  chart: {\n    borderRadius: 16,\n  },\n  applyButton: {\n    backgroundColor: '#4F46E5',\n    marginHorizontal: 16,\n    marginTop: 24,\n    marginBottom: 24,\n    paddingVertical: 16,\n    borderRadius: 12,\n    alignItems: 'center',\n  },\n  applyButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":7783},"frontend/app/apply.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TextInput,\n  ScrollView,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport * as ImagePicker from 'expo-image-picker';\nimport { router } from 'expo-router';\nimport { api } from '../lib/api';\nimport { useAuth } from '../contexts/AuthContext';\nimport { loanProducts } from '../utils/loanProducts';\n\nexport default function ApplyScreen() {\n  const { user, isLoading: authLoading } = useAuth();\n  const [selectedProduct, setSelectedProduct] = useState(loanProducts[0]);\n  const [amount, setAmount] = useState('');\n  const [term, setTerm] = useState('');\n  const [purpose, setPurpose] = useState('');\n  const [monthlyIncome, setMonthlyIncome] = useState('');\n  const [employmentStatus, setEmploymentStatus] = useState('');\n  const [documents, setDocuments] = useState<string[]>([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const pickDocument = async () => {\n    const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();\n    \n    if (status !== 'granted') {\n      Alert.alert('Permission required', 'Please grant camera roll permissions');\n      return;\n    }\n\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\n      allowsEditing: false,\n      quality: 0.8,\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      setDocuments([...documents, result.assets[0].uri]);\n      Alert.alert('Success', 'Document uploaded successfully');\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!user) {\n      Alert.alert('Authentication Required', 'Please sign in to apply for a loan', [\n        { text: 'Sign In', onPress: () => router.push('/login') },\n        { text: 'Cancel', style: 'cancel' },\n      ]);\n      return;\n    }\n\n    if (!amount || !term || !purpose || !monthlyIncome || !employmentStatus) {\n      Alert.alert('Error', 'Please fill in all required fields');\n      return;\n    }\n\n    const loanAmount = parseFloat(amount);\n    const loanTerm = parseInt(term);\n\n    if (loanAmount < selectedProduct.minAmount || loanAmount > selectedProduct.maxAmount) {\n      Alert.alert('Error', `Loan amount must be between $${selectedProduct.minAmount} and $${selectedProduct.maxAmount}`);\n      return;\n    }\n\n    if (loanTerm < selectedProduct.minTerm || loanTerm > selectedProduct.maxTerm) {\n      Alert.alert('Error', `Loan term must be between ${selectedProduct.minTerm} and ${selectedProduct.maxTerm} months`);\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      await api.post('/loans', {\n        amount: loanAmount,\n        term_months: loanTerm,\n        purpose,\n        loan_type: selectedProduct.id,\n        monthly_income: parseFloat(monthlyIncome),\n        employment_status: employmentStatus,\n      });\n\n      Alert.alert(\n        'Application Submitted!',\n        'Your loan application has been submitted successfully. You can track its status in the Status tab.',\n        [\n          {\n            text: 'View Status',\n            onPress: () => router.push('/status'),\n          },\n        ]\n      );\n      \n      setAmount('');\n      setTerm('');\n      setPurpose('');\n      setMonthlyIncome('');\n      setEmploymentStatus('');\n      setDocuments([]);\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to submit application. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <ScrollView style={styles.container}>\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>Loan Application</Text>\n        <Text style={styles.headerSubtitle}>\n          Complete the form below to apply\n        </Text>\n      </View>\n\n      <View style={styles.formSection}>\n        <Text style={styles.sectionTitle}>Loan Details</Text>\n        \n        <Text style={styles.label}>Select Loan Type</Text>\n        <View style={styles.productSelector}>\n          {loanProducts.map((product) => (\n            <TouchableOpacity\n              key={product.id}\n              style={[\n                styles.productButton,\n                selectedProduct.id === product.id && styles.productButtonActive,\n              ]}\n              onPress={() => setSelectedProduct(product)}\n            >\n              <Text style={styles.productIcon}>{product.icon}</Text>\n              <Text\n                style={[\n                  styles.productButtonText,\n                  selectedProduct.id === product.id && styles.productButtonTextActive,\n                ]}\n              >\n                {product.name}\n              </Text>\n            </TouchableOpacity>\n          ))}\n        </View>\n\n        <Text style={styles.label}>Loan Amount *</Text>\n        <TextInput\n          style={styles.input}\n          value={amount}\n          onChangeText={setAmount}\n          placeholder={`$${selectedProduct.minAmount} - $${selectedProduct.maxAmount}`}\n          keyboardType=\"numeric\"\n        />\n\n        <Text style={styles.label}>Loan Term (Months) *</Text>\n        <TextInput\n          style={styles.input}\n          value={term}\n          onChangeText={setTerm}\n          placeholder={`${selectedProduct.minTerm} - ${selectedProduct.maxTerm} months`}\n          keyboardType=\"numeric\"\n        />\n\n        <Text style={styles.label}>Purpose *</Text>\n        <TextInput\n          style={styles.input}\n          value={purpose}\n          onChangeText={setPurpose}\n          placeholder=\"e.g., Business expansion, Education, Home renovation\"\n          multiline\n          numberOfLines={3}\n        />\n      </View>\n\n      <View style={styles.formSection}>\n        <Text style={styles.sectionTitle}>Financial Information</Text>\n\n        <Text style={styles.label}>Monthly Income *</Text>\n        <TextInput\n          style={styles.input}\n          value={monthlyIncome}\n          onChangeText={setMonthlyIncome}\n          placeholder=\"$5000\"\n          keyboardType=\"numeric\"\n        />\n\n        <Text style={styles.label}>Employment Status *</Text>\n        <TextInput\n          style={styles.input}\n          value={employmentStatus}\n          onChangeText={setEmploymentStatus}\n          placeholder=\"Full-time, Part-time, Self-employed, etc.\"\n        />\n      </View>\n\n      <View style={styles.formSection}>\n        <Text style={styles.sectionTitle}>Documents</Text>\n        <Text style={styles.label}>Upload Supporting Documents</Text>\n        <Text style={styles.helperText}>\n          Upload ID, proof of income, or other relevant documents\n        </Text>\n\n        <TouchableOpacity style={styles.uploadButton} onPress={pickDocument}>\n          <Text style={styles.uploadButtonText}>📎 Upload Document</Text>\n        </TouchableOpacity>\n\n        {documents.length > 0 && (\n          <View style={styles.documentsContainer}>\n            <Text style={styles.documentsTitle}>\n              Uploaded: {documents.length} document(s)\n            </Text>\n          </View>\n        )}\n      </View>\n\n      <TouchableOpacity \n        style={[styles.submitButton, isSubmitting && styles.submitButtonDisabled]} \n        onPress={handleSubmit}\n        disabled={isSubmitting}\n      >\n        {isSubmitting ? (\n          <ActivityIndicator color=\"#FFFFFF\" />\n        ) : (\n          <Text style={styles.submitButtonText}>Submit Application</Text>\n        )}\n      </TouchableOpacity>\n\n      <View style={styles.disclaimer}>\n        <Text style={styles.disclaimerText}>\n          By submitting this application, you agree to our terms and conditions\n          and authorize us to verify the information provided.\n        </Text>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  header: {\n    backgroundColor: '#4F46E5',\n    padding: 24,\n    paddingTop: 32,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#FFFFFF',\n    marginBottom: 8,\n  },\n  headerSubtitle: {\n    fontSize: 16,\n    color: '#E0E7FF',\n  },\n  formSection: {\n    backgroundColor: '#FFFFFF',\n    marginHorizontal: 16,\n    marginTop: 16,\n    padding: 20,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.08,\n    shadowRadius: 3,\n    elevation: 2,\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 16,\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#374151',\n    marginBottom: 8,\n    marginTop: 8,\n  },\n  input: {\n    backgroundColor: '#F9FAFB',\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: '#D1D5DB',\n    paddingHorizontal: 12,\n    paddingVertical: 12,\n    fontSize: 16,\n    color: '#111827',\n    marginBottom: 8,\n  },\n  helperText: {\n    fontSize: 13,\n    color: '#6B7280',\n    marginBottom: 12,\n  },\n  productSelector: {\n    marginBottom: 16,\n  },\n  productButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: '#F9FAFB',\n    borderWidth: 2,\n    borderColor: '#E5E7EB',\n    borderRadius: 8,\n    padding: 16,\n    marginBottom: 8,\n  },\n  productButtonActive: {\n    borderColor: '#4F46E5',\n    backgroundColor: '#EEF2FF',\n  },\n  productIcon: {\n    fontSize: 24,\n    marginRight: 12,\n  },\n  productButtonText: {\n    fontSize: 16,\n    color: '#6B7280',\n    fontWeight: '600',\n  },\n  productButtonTextActive: {\n    color: '#4F46E5',\n  },\n  uploadButton: {\n    backgroundColor: '#4F46E5',\n    paddingVertical: 12,\n    borderRadius: 8,\n    alignItems: 'center',\n  },\n  uploadButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: '600',\n  },\n  documentsContainer: {\n    marginTop: 12,\n    padding: 12,\n    backgroundColor: '#F0FDF4',\n    borderRadius: 8,\n  },\n  documentsTitle: {\n    fontSize: 14,\n    color: '#16A34A',\n    fontWeight: '600',\n  },\n  submitButton: {\n    backgroundColor: '#4F46E5',\n    marginHorizontal: 16,\n    marginTop: 24,\n    paddingVertical: 16,\n    borderRadius: 12,\n    alignItems: 'center',\n  },\n  submitButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  submitButtonDisabled: {\n    backgroundColor: '#A5B4FC',\n  },\n  disclaimer: {\n    marginHorizontal: 16,\n    marginTop: 16,\n    marginBottom: 24,\n    padding: 16,\n    backgroundColor: '#FEF3C7',\n    borderRadius: 8,\n  },\n  disclaimerText: {\n    fontSize: 12,\n    color: '#92400E',\n    textAlign: 'center',\n  },\n});\n","size_bytes":10395},"frontend/app/profile.tsx":{"content":"import React from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { useAuth } from '../contexts/AuthContext';\nimport { Ionicons } from '@expo/vector-icons';\n\nexport default function ProfileScreen() {\n  const { user, isLoading, signOut, hasRole } = useAuth();\n\n  const handleLogout = async () => {\n    Alert.alert(\n      'Logout',\n      'Are you sure you want to logout?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Logout',\n          style: 'destructive',\n          onPress: async () => {\n            await signOut();\n            router.replace('/');\n          },\n        },\n      ]\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color=\"#4F46E5\" />\n        <Text style={styles.loadingText}>Loading...</Text>\n      </View>\n    );\n  }\n\n  if (!user) {\n    return (\n      <ScrollView style={styles.container} contentContainerStyle={styles.contentContainer}>\n        <View style={styles.guestContainer}>\n          <Ionicons name=\"person-circle-outline\" size={100} color=\"#9CA3AF\" />\n          <Text style={styles.guestTitle}>Welcome to QuickLoan</Text>\n          <Text style={styles.guestSubtitle}>\n            Sign in to manage your loans and track your applications\n          </Text>\n          \n          <View style={styles.buttonContainer}>\n            <TouchableOpacity\n              style={styles.loginButton}\n              onPress={() => router.push('/login')}\n            >\n              <Text style={styles.loginButtonText}>Sign In</Text>\n            </TouchableOpacity>\n            \n            <TouchableOpacity\n              style={styles.registerButton}\n              onPress={() => router.push('/register')}\n            >\n              <Text style={styles.registerButtonText}>Create Account</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </ScrollView>\n    );\n  }\n\n  return (\n    <ScrollView style={styles.container}>\n      <View style={styles.header}>\n        <View style={styles.avatarContainer}>\n          <Ionicons name=\"person-circle\" size={80} color=\"#4F46E5\" />\n        </View>\n        <Text style={styles.userName}>{user.full_name || user.email}</Text>\n        <Text style={styles.userEmail}>{user.email}</Text>\n        {user.phone && <Text style={styles.userPhone}>{user.phone}</Text>}\n      </View>\n\n      <View style={styles.rolesContainer}>\n        <Text style={styles.sectionTitle}>Roles</Text>\n        <View style={styles.rolesList}>\n          {user.roles && user.roles.length > 0 ? (\n            user.roles.map((role, index) => (\n              <View key={index} style={styles.roleTag}>\n                <Ionicons name=\"shield-checkmark\" size={16} color=\"#4F46E5\" />\n                <Text style={styles.roleText}>{role.toUpperCase()}</Text>\n              </View>\n            ))\n          ) : (\n            <Text style={styles.noRoles}>No roles assigned</Text>\n          )}\n        </View>\n      </View>\n\n      <View style={styles.menuContainer}>\n        <Text style={styles.sectionTitle}>Quick Actions</Text>\n        \n        {hasRole('admin') && (\n          <TouchableOpacity\n            style={styles.menuItem}\n            onPress={() => router.push('/admin')}\n          >\n            <Ionicons name=\"shield\" size={24} color=\"#4F46E5\" />\n            <Text style={styles.menuItemText}>Admin Dashboard</Text>\n            <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n          </TouchableOpacity>\n        )}\n\n        {hasRole('rider') && (\n          <TouchableOpacity\n            style={styles.menuItem}\n            onPress={() => router.push('/rider')}\n          >\n            <Ionicons name=\"bicycle\" size={24} color=\"#4F46E5\" />\n            <Text style={styles.menuItemText}>Rider Portal</Text>\n            <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n          </TouchableOpacity>\n        )}\n\n        <TouchableOpacity\n          style={styles.menuItem}\n          onPress={() => router.push('/status')}\n        >\n          <Ionicons name=\"document-text\" size={24} color=\"#4F46E5\" />\n          <Text style={styles.menuItemText}>My Loans</Text>\n          <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={styles.menuItem}\n          onPress={() => router.push('/calculator')}\n        >\n          <Ionicons name=\"calculator\" size={24} color=\"#4F46E5\" />\n          <Text style={styles.menuItemText}>Loan Calculator</Text>\n          <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n        </TouchableOpacity>\n      </View>\n\n      <View style={styles.settingsContainer}>\n        <Text style={styles.sectionTitle}>Settings</Text>\n        \n        <TouchableOpacity\n          style={styles.menuItem}\n          onPress={() => Alert.alert('Notifications', 'Notification settings coming soon!')}\n        >\n          <Ionicons name=\"notifications\" size={24} color=\"#6B7280\" />\n          <Text style={styles.menuItemText}>Notifications</Text>\n          <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={styles.menuItem}\n          onPress={() => Alert.alert('Privacy', 'Privacy settings coming soon!')}\n        >\n          <Ionicons name=\"lock-closed\" size={24} color=\"#6B7280\" />\n          <Text style={styles.menuItemText}>Privacy & Security</Text>\n          <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={styles.menuItem}\n          onPress={() => Alert.alert('Help', 'Help center coming soon!')}\n        >\n          <Ionicons name=\"help-circle\" size={24} color=\"#6B7280\" />\n          <Text style={styles.menuItemText}>Help & Support</Text>\n          <Ionicons name=\"chevron-forward\" size={24} color=\"#9CA3AF\" />\n        </TouchableOpacity>\n      </View>\n\n      <TouchableOpacity style={styles.logoutButton} onPress={handleLogout}>\n        <Ionicons name=\"log-out\" size={24} color=\"#DC2626\" />\n        <Text style={styles.logoutButtonText}>Logout</Text>\n      </TouchableOpacity>\n\n      <View style={styles.footer}>\n        <Text style={styles.footerText}>QuickLoan v1.0.0</Text>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  contentContainer: {\n    flexGrow: 1,\n    justifyContent: 'center',\n    padding: 20,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#F9FAFB',\n  },\n  loadingText: {\n    marginTop: 12,\n    fontSize: 16,\n    color: '#6B7280',\n  },\n  guestContainer: {\n    alignItems: 'center',\n    padding: 32,\n  },\n  guestTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginTop: 24,\n    marginBottom: 8,\n  },\n  guestSubtitle: {\n    fontSize: 16,\n    color: '#6B7280',\n    textAlign: 'center',\n    marginBottom: 32,\n  },\n  buttonContainer: {\n    width: '100%',\n  },\n  loginButton: {\n    backgroundColor: '#4F46E5',\n    borderRadius: 12,\n    padding: 16,\n    alignItems: 'center',\n    marginBottom: 12,\n  },\n  loginButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  registerButton: {\n    backgroundColor: '#FFFFFF',\n    borderWidth: 2,\n    borderColor: '#4F46E5',\n    borderRadius: 12,\n    padding: 16,\n    alignItems: 'center',\n  },\n  registerButtonText: {\n    color: '#4F46E5',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  header: {\n    backgroundColor: '#FFFFFF',\n    alignItems: 'center',\n    padding: 32,\n    borderBottomWidth: 1,\n    borderBottomColor: '#E5E7EB',\n  },\n  avatarContainer: {\n    marginBottom: 16,\n  },\n  userName: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 4,\n  },\n  userEmail: {\n    fontSize: 14,\n    color: '#6B7280',\n    marginBottom: 4,\n  },\n  userPhone: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  rolesContainer: {\n    backgroundColor: '#FFFFFF',\n    padding: 20,\n    marginTop: 12,\n  },\n  sectionTitle: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 12,\n  },\n  rolesList: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 8,\n  },\n  roleTag: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: '#EEF2FF',\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 16,\n    gap: 4,\n  },\n  roleText: {\n    fontSize: 12,\n    fontWeight: '600',\n    color: '#4F46E5',\n  },\n  noRoles: {\n    fontSize: 14,\n    color: '#9CA3AF',\n    fontStyle: 'italic',\n  },\n  menuContainer: {\n    backgroundColor: '#FFFFFF',\n    padding: 20,\n    marginTop: 12,\n  },\n  settingsContainer: {\n    backgroundColor: '#FFFFFF',\n    padding: 20,\n    marginTop: 12,\n  },\n  menuItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: 12,\n    borderBottomWidth: 1,\n    borderBottomColor: '#F3F4F6',\n    gap: 12,\n  },\n  menuItemText: {\n    flex: 1,\n    fontSize: 16,\n    color: '#111827',\n  },\n  logoutButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: '#FFFFFF',\n    margin: 20,\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: '#FCA5A5',\n    gap: 8,\n  },\n  logoutButtonText: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    color: '#DC2626',\n  },\n  footer: {\n    alignItems: 'center',\n    padding: 20,\n  },\n  footerText: {\n    fontSize: 12,\n    color: '#9CA3AF',\n  },\n});\n","size_bytes":9640},"backend/src/routes/admin.ts":{"content":"import { Router } from 'express';\nimport * as adminController from '../controllers/adminController';\nimport { authenticate, requireRole } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.use(authenticate);\nrouter.use(requireRole('admin'));\n\nrouter.get('/loans', adminController.getAllLoans);\nrouter.put('/loans/:id', adminController.updateLoanStatus);\nrouter.post('/loans/:id/assign', adminController.assignRider);\n\nrouter.get('/riders', adminController.getAllRiders);\nrouter.post('/riders', adminController.createRider);\n\nrouter.get('/metrics', adminController.getMetrics);\n\nexport default router;\n","size_bytes":611},"frontend/app/login.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { useAuth } from '../contexts/AuthContext';\n\nexport default function LoginScreen() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const { signIn } = useAuth();\n\n  const handleLogin = async () => {\n    if (!email || !password) {\n      Alert.alert('Error', 'Please fill in all fields');\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      await signIn(email, password);\n      router.replace('/');\n    } catch (error: any) {\n      Alert.alert('Login Failed', error.message || 'Invalid credentials');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <ScrollView style={styles.container} contentContainerStyle={styles.contentContainer}>\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>Welcome Back</Text>\n        <Text style={styles.headerSubtitle}>Sign in to continue to QuickLoan</Text>\n      </View>\n\n      <View style={styles.form}>\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Email</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"your.email@example.com\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={email}\n            onChangeText={setEmail}\n            autoCapitalize=\"none\"\n            keyboardType=\"email-address\"\n            editable={!isLoading}\n          />\n        </View>\n\n        <View style={styles.inputGroup}>\n          <Text style={styles.label}>Password</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"Enter your password\"\n            placeholderTextColor=\"#9CA3AF\"\n            value={password}\n            onChangeText={setPassword}\n            secureTextEntry\n            editable={!isLoading}\n          />\n        </View>\n\n        <TouchableOpacity\n          style={[styles.loginButton, isLoading && styles.loginButtonDisabled]}\n          onPress={handleLogin}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator color=\"#FFFFFF\" />\n          ) : (\n            <Text style={styles.loginButtonText}>Sign In</Text>\n          )}\n        </TouchableOpacity>\n\n        <View style={styles.divider}>\n          <View style={styles.dividerLine} />\n          <Text style={styles.dividerText}>OR</Text>\n          <View style={styles.dividerLine} />\n        </View>\n\n        <TouchableOpacity\n          style={styles.registerLink}\n          onPress={() => router.push('/register')}\n          disabled={isLoading}\n        >\n          <Text style={styles.registerLinkText}>\n            Don't have an account? <Text style={styles.registerLinkBold}>Sign Up</Text>\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      <View style={styles.footer}>\n        <Text style={styles.footerText}>Secure & Trusted Loan Platform</Text>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  contentContainer: {\n    flexGrow: 1,\n    justifyContent: 'center',\n    padding: 20,\n  },\n  header: {\n    marginBottom: 40,\n    alignItems: 'center',\n  },\n  headerTitle: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 8,\n  },\n  headerSubtitle: {\n    fontSize: 16,\n    color: '#6B7280',\n  },\n  form: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 16,\n    padding: 24,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 3,\n  },\n  inputGroup: {\n    marginBottom: 20,\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#374151',\n    marginBottom: 8,\n  },\n  input: {\n    backgroundColor: '#F9FAFB',\n    borderWidth: 1,\n    borderColor: '#E5E7EB',\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 16,\n    color: '#111827',\n  },\n  loginButton: {\n    backgroundColor: '#4F46E5',\n    borderRadius: 8,\n    padding: 16,\n    alignItems: 'center',\n    marginTop: 8,\n  },\n  loginButtonDisabled: {\n    backgroundColor: '#A5B4FC',\n  },\n  loginButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  divider: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: 24,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: '#E5E7EB',\n  },\n  dividerText: {\n    marginHorizontal: 16,\n    color: '#9CA3AF',\n    fontSize: 14,\n  },\n  registerLink: {\n    alignItems: 'center',\n  },\n  registerLinkText: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  registerLinkBold: {\n    color: '#4F46E5',\n    fontWeight: 'bold',\n  },\n  footer: {\n    marginTop: 32,\n    alignItems: 'center',\n  },\n  footerText: {\n    fontSize: 12,\n    color: '#9CA3AF',\n  },\n});\n","size_bytes":4963},"frontend/utils/storage.ts":{"content":"import AsyncStorage from '@react-native-async-storage/async-storage';\nimport { LoanApplication } from '../types';\n\nconst APPLICATIONS_KEY = '@loan_applications';\n\nexport const saveApplication = async (application: LoanApplication): Promise<void> => {\n  try {\n    const existingData = await AsyncStorage.getItem(APPLICATIONS_KEY);\n    const applications: LoanApplication[] = existingData ? JSON.parse(existingData) : [];\n    applications.push(application);\n    await AsyncStorage.setItem(APPLICATIONS_KEY, JSON.stringify(applications));\n  } catch (error) {\n    console.error('Error saving application:', error);\n    throw error;\n  }\n};\n\nexport const getApplications = async (): Promise<LoanApplication[]> => {\n  try {\n    const data = await AsyncStorage.getItem(APPLICATIONS_KEY);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error('Error loading applications:', error);\n    return [];\n  }\n};\n\nexport const updateApplicationStatus = async (\n  id: string,\n  status: LoanApplication['status']\n): Promise<void> => {\n  try {\n    const applications = await getApplications();\n    const updated = applications.map(app =>\n      app.id === id ? { ...app, status } : app\n    );\n    await AsyncStorage.setItem(APPLICATIONS_KEY, JSON.stringify(updated));\n  } catch (error) {\n    console.error('Error updating application:', error);\n    throw error;\n  }\n};\n","size_bytes":1372},"backend/src/controllers/authController.ts":{"content":"import { Request, Response } from 'express';\nimport { supabase } from '../config/supabase';\nimport { AppError } from '../middleware/errorHandler';\nimport { AuthRequest } from '../middleware/auth';\n\nexport const register = async (req: Request, res: Response) => {\n  try {\n    const { email, password, full_name, phone } = req.body;\n\n    if (!email || !password || !full_name) {\n      throw new AppError('Email, password, and full name are required', 400);\n    }\n\n    const { data: authData, error: authError } = await supabase.auth.signUp({\n      email,\n      password,\n    });\n\n    if (authError) {\n      throw new AppError(authError.message, 400);\n    }\n\n    if (!authData.user) {\n      throw new AppError('Failed to create user', 500);\n    }\n\n    const { data: userData, error: userError } = await supabase\n      .from('users')\n      .insert([\n        {\n          id: authData.user.id,\n          full_name,\n          phone: phone || null,\n        }\n      ])\n      .select()\n      .single();\n\n    if (userError) {\n      await supabase.auth.admin.deleteUser(authData.user.id);\n      throw new AppError('Failed to create user profile', 500);\n    }\n\n    const { data: borrowerRole } = await supabase\n      .from('roles')\n      .select('id')\n      .eq('name', 'borrower')\n      .single();\n\n    if (borrowerRole) {\n      await supabase.from('user_roles').insert([\n        {\n          user_id: authData.user.id,\n          role_id: borrowerRole.id,\n        }\n      ]);\n\n      await supabase.from('borrower_profiles').insert([\n        {\n          user_id: authData.user.id,\n        }\n      ]);\n    }\n\n    res.status(201).json({\n      message: 'User registered successfully',\n      user: userData,\n      session: authData.session,\n    });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Registration error:', error);\n      res.status(500).json({ error: 'Registration failed' });\n    }\n  }\n};\n\nexport const login = async (req: Request, res: Response) => {\n  try {\n    const { email, password } = req.body;\n\n    if (!email || !password) {\n      throw new AppError('Email and password are required', 400);\n    }\n\n    const { data, error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n\n    if (error) {\n      throw new AppError('Invalid credentials', 401);\n    }\n\n    const { data: userRoles } = await supabase\n      .from('user_roles')\n      .select('roles(name)')\n      .eq('user_id', data.user.id);\n\n    const roles = userRoles?.map((ur: any) => ur.roles.name) || [];\n\n    const { data: userProfile } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', data.user.id)\n      .single();\n\n    res.json({\n      message: 'Login successful',\n      session: data.session,\n      user: {\n        ...userProfile,\n        email: data.user.email,\n        roles,\n      },\n    });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Login error:', error);\n      res.status(500).json({ error: 'Login failed' });\n    }\n  }\n};\n\nexport const getProfile = async (req: AuthRequest, res: Response) => {\n  try {\n    if (!req.user) {\n      throw new AppError('Not authenticated', 401);\n    }\n\n    const { data: userProfile, error } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', req.user.id)\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to fetch profile', 500);\n    }\n\n    res.json({\n      user: {\n        ...userProfile,\n        email: req.user.email,\n        roles: req.user.roles,\n      },\n    });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Profile fetch error:', error);\n      res.status(500).json({ error: 'Failed to fetch profile' });\n    }\n  }\n};\n\nexport const logout = async (req: AuthRequest, res: Response) => {\n  try {\n    const authHeader = req.headers.authorization;\n    if (authHeader && authHeader.startsWith('Bearer ')) {\n      const token = authHeader.split(' ')[1];\n      await supabase.auth.admin.signOut(token);\n    }\n\n    res.json({ message: 'Logout successful' });\n  } catch (error) {\n    console.error('Logout error:', error);\n    res.status(500).json({ error: 'Logout failed' });\n  }\n};\n","size_bytes":4414},"backend/src/middleware/errorHandler.ts":{"content":"import { Request, Response, NextFunction } from 'express';\n\nexport class AppError extends Error {\n  statusCode: number;\n  isOperational: boolean;\n\n  constructor(message: string, statusCode: number) {\n    super(message);\n    this.statusCode = statusCode;\n    this.isOperational = true;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\nexport const errorHandler = (\n  err: Error | AppError,\n  _req: Request,\n  res: Response,\n  _next: NextFunction\n): void => {\n  if (err instanceof AppError) {\n    return res.status(err.statusCode).json({\n      error: err.message,\n      status: err.statusCode\n    });\n  }\n\n  console.error('Unexpected error:', err);\n\n  res.status(500).json({\n    error: 'Internal server error',\n    status: 500,\n    ...(process.env.NODE_ENV === 'development' && { stack: err.stack })\n  });\n};\n\nexport const notFound = (req: Request, res: Response) => {\n  res.status(404).json({\n    error: 'Resource not found',\n    status: 404,\n    path: req.originalUrl\n  });\n};\n","size_bytes":988},"backend/src/routes/loans.ts":{"content":"import { Router } from 'express';\nimport * as loanController from '../controllers/loanController';\nimport { authenticate, requireRole } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.use(authenticate);\nrouter.use(requireRole('borrower', 'admin'));\n\nrouter.post('/', loanController.createLoan);\nrouter.get('/', loanController.getLoans);\nrouter.get('/:id', loanController.getLoanById);\nrouter.post('/:id/documents', loanController.uploadLoanDocument);\n\nexport default router;\n","size_bytes":488},"frontend/app/_layout.tsx":{"content":"import { Tabs } from 'expo-router';\nimport { Ionicons } from '@expo/vector-icons';\nimport { AuthProvider } from '../contexts/AuthContext';\n\nexport default function Layout() {\n  return (\n    <AuthProvider>\n      <Tabs\n        screenOptions={{\n          tabBarActiveTintColor: '#4F46E5',\n          tabBarInactiveTintColor: '#9CA3AF',\n          tabBarStyle: {\n            backgroundColor: '#FFFFFF',\n            borderTopWidth: 1,\n            borderTopColor: '#E5E7EB',\n            height: 60,\n            paddingBottom: 8,\n            paddingTop: 8,\n          },\n          tabBarLabelStyle: {\n            fontSize: 12,\n            fontWeight: '600',\n          },\n          headerStyle: {\n            backgroundColor: '#4F46E5',\n          },\n          headerTintColor: '#FFFFFF',\n          headerTitleStyle: {\n            fontWeight: 'bold',\n          },\n        }}\n      >\n        <Tabs.Screen\n          name=\"index\"\n          options={{\n            title: 'Home',\n            tabBarIcon: ({ color, size }) => (\n              <Ionicons name=\"home\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tabs.Screen\n          name=\"calculator\"\n          options={{\n            title: 'Calculator',\n            tabBarIcon: ({ color, size }) => (\n              <Ionicons name=\"calculator\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tabs.Screen\n          name=\"apply\"\n          options={{\n            title: 'Apply',\n            tabBarIcon: ({ color, size }) => (\n              <Ionicons name=\"document-text\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tabs.Screen\n          name=\"status\"\n          options={{\n            title: 'Status',\n            tabBarIcon: ({ color, size }) => (\n              <Ionicons name=\"list\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tabs.Screen\n          name=\"profile\"\n          options={{\n            title: 'Profile',\n            tabBarIcon: ({ color, size }) => (\n              <Ionicons name=\"person\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tabs.Screen\n          name=\"login\"\n          options={{\n            href: null,\n          }}\n        />\n        <Tabs.Screen\n          name=\"register\"\n          options={{\n            href: null,\n          }}\n        />\n        <Tabs.Screen\n          name=\"admin\"\n          options={{\n            href: null,\n          }}\n        />\n        <Tabs.Screen\n          name=\"rider\"\n          options={{\n            href: null,\n          }}\n        />\n      </Tabs>\n    </AuthProvider>\n  );\n}\n","size_bytes":2619},"frontend/lib/supabase.ts":{"content":"import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.EXPO_PUBLIC_SUPABASE_URL || '';\nconst supabaseAnonKey = process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || '';\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  console.warn('⚠️ Supabase credentials not configured. Authentication features will be disabled.');\n  console.warn('Please set SUPABASE_URL and SUPABASE_ANON_KEY in the Replit Secrets to enable authentication.');\n}\n\nexport const supabase = createClient(\n  supabaseUrl || 'https://placeholder.supabase.co',\n  supabaseAnonKey || 'placeholder-key',\n  {\n    auth: {\n      autoRefreshToken: true,\n      persistSession: true,\n      detectSessionInUrl: false,\n    },\n  }\n);\n","size_bytes":705},"backend/src/routes/auth.ts":{"content":"import { Router } from 'express';\nimport * as authController from '../controllers/authController';\nimport { authenticate } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.post('/register', authController.register);\nrouter.post('/login', authController.login);\nrouter.post('/logout', authenticate, authController.logout);\nrouter.get('/me', authenticate, authController.getProfile);\n\nexport default router;\n","size_bytes":418},"SETUP_COMPLETE.md":{"content":"# 🎉 QuickLoan - Replit Setup Complete!\n\n**Setup Date**: November 12, 2025  \n**Status**: ✅ Frontend Running | ⏳ Backend Awaiting Credentials\n\n---\n\n## 📱 Your Beautiful React Native Expo App\n\nYour app is **running beautifully** with a stunning modern design! Here's what's already built and working:\n\n### ✅ Complete & Working Screens\n\n#### 🏠 **Home Screen** - BEAUTIFUL!\n- Indigo header with welcome message\n- Stats showcase ($500M+ Loans, 50K+ Customers, 4.8★ Rating)\n- Three loan product cards with icons:\n  - 💰 Personal Loan - 8.5% APR, up to $50,000\n  - 🏢 Business Loan - 6.5% APR, up to $500,000\n  - 🎓 Education Loan - 4.5% APR, up to $100,000\n- Call-to-action button\n- Tab navigation at bottom\n\n#### 🧮 **Calculator Screen** - BEAUTIFUL!\n- Clean input fields for amount, rate, and term\n- Real-time calculation\n- Large, prominent monthly payment display\n- Total payment summary\n- Perfect for users to estimate their loan costs\n\n#### 📝 **Apply Screen** - BEAUTIFUL!\n- Loan type selector with beautiful active states\n- Form sections:\n  - Loan Details (amount, term, purpose)\n  - Financial Information (income, employment)\n  - Document Upload\n- Professional disclaimers\n- Connected to backend API\n- Form validation\n\n#### 📊 **Status Screen** - BEAUTIFUL!\n- Loan application cards with status badges\n- Color-coded status indicators:\n  - Green: Approved/Disbursed ✓\n  - Orange: Under Review ⟳\n  - Red: Rejected ✕\n  - Gray: Pending ⋯\n- Detailed loan information\n- Pull-to-refresh functionality\n- Empty states with clear CTAs\n\n#### 👤 **Profile Screen** - BEAUTIFUL!\n- Guest mode with Sign In / Create Account buttons\n- Logged-in mode shows:\n  - User avatar and info\n  - Role badges\n  - Quick actions menu (Admin Dashboard, Rider Portal, My Loans, Calculator)\n  - Settings menu (Notifications, Privacy, Help)\n  - Logout button\n- Role-based navigation\n\n---\n\n## 🎨 Design System Analysis\n\nYour app follows a **professional, modern design language**:\n\n### Color Palette\n- **Primary**: #4F46E5 (Indigo) - Brand color, headers, buttons\n- **Background**: #F9FAFB (Light Gray) - App background\n- **Cards**: #FFFFFF (White) - Card backgrounds\n- **Text Primary**: #111827 (Dark Gray) - Main text\n- **Text Secondary**: #6B7280 (Medium Gray) - Subtitles, labels\n- **Success**: #10B981 (Green) - Approved status\n- **Warning**: #F59E0B (Orange) - Under review\n- **Error**: #DC2626 (Red) - Rejected status\n\n### Typography\n- **Headers**: 28px, bold, white or primary\n- **Section Titles**: 18-20px, bold\n- **Body Text**: 14-16px, regular\n- **Labels**: 14px, semi-bold\n\n### Components\n- **Cards**: 12px border radius, subtle shadows (elevation 2-3)\n- **Buttons**: 12px border radius, indigo primary color\n- **Spacing**: Consistent 16-24px padding\n- **Icons**: Expo Ionicons, 24px for navigation\n\n---\n\n## 🏗️ Architecture Overview\n\n### Frontend (React Native Expo)\n```\n✅ Home Screen (index.tsx) - COMPLETE\n✅ Calculator Screen (calculator.tsx) - COMPLETE  \n✅ Apply Screen (apply.tsx) - COMPLETE\n✅ Status Screen (status.tsx) - COMPLETE\n✅ Profile Screen (profile.tsx) - COMPLETE\n⏳ Login Screen (login.tsx) - NEEDS UI\n⏳ Register Screen (register.tsx) - NEEDS UI\n⏳ Admin Dashboard (admin.tsx) - NEEDS UI\n⏳ Rider Portal (rider.tsx) - NEEDS UI\n✅ Auth Context - COMPLETE\n✅ API Client - COMPLETE\n✅ Tab Navigation - COMPLETE\n```\n\n### Backend (Express + TypeScript)\n```\n✅ Server Setup - COMPLETE\n✅ Authentication Routes - COMPLETE\n✅ Loan Routes - COMPLETE\n✅ Admin Routes - COMPLETE\n✅ Rider Routes - COMPLETE\n✅ Database Schema (schema.sql) - COMPLETE\n⏳ Waiting for Supabase Credentials\n```\n\n---\n\n## 🚀 Current Setup Status\n\n### ✅ What's Running\n1. **Frontend Workflow**: Port 5000, Expo web server\n2. **Dependencies**: All npm packages installed\n3. **Environment**: Configured for Replit\n4. **Navigation**: Tab-based routing working\n5. **Design System**: Consistent throughout\n\n### ⏳ What's Needed\n1. **Supabase Credentials** (I've already asked for these):\n   - SUPABASE_URL\n   - SUPABASE_SERVICE_KEY\n   - SUPABASE_ANON_KEY\n\n2. **Database Setup** (After credentials provided):\n   - Run `schema.sql` in Supabase SQL Editor\n   - Creates all tables with Row Level Security\n   - Sets up roles and permissions\n\n3. **Complete Remaining Screens**:\n   - Login/Register screens (UI + backend connection)\n   - Admin Dashboard (UI for loan management)\n   - Rider Portal (UI for field agents)\n\n---\n\n## 📋 Next Development Steps\n\n### Priority 1: Authentication Screens (After Supabase Setup)\n\n#### Login Screen\n- Email/password form\n- Sign in button\n- Link to registration\n- \"Forgot Password\" link\n- Maintain indigo design theme\n\n#### Register Screen\n- Full name, email, password, phone fields\n- Terms & conditions checkbox\n- Create account button\n- Link to login\n- Same beautiful card-based design\n\n### Priority 2: Admin Dashboard\n\n#### Features Needed:\n- **Loan Queue**: List of all pending/reviewing loans\n- **Loan Details Modal**: Review application details\n- **Approve/Reject Actions**: Update loan status\n- **Rider Management**: Create/edit riders\n- **Assign Rider**: Assign loans to field agents\n- **Analytics Cards**: Total loans, approval rate, disbursed amount\n\n#### Design Style:\n- Cards with stats (similar to home screen)\n- Table/list view for loans\n- Action buttons in indigo\n- Status badges (reuse from status screen)\n\n### Priority 3: Rider Portal\n\n#### Features Needed:\n- **Assignment List**: Loans assigned to this rider\n- **Update Status**: Mark as in_progress, verified, completed\n- **Upload Photos**: Verification documents\n- **Availability Toggle**: Active/inactive status\n- **My Metrics**: Completed assignments, success rate\n\n#### Design Style:\n- Card-based layout\n- Toggle switches for availability\n- Photo upload similar to apply screen\n- Status updates with clear feedback\n\n---\n\n## 🎯 Design Guidelines for New Screens\n\nWhen building the remaining screens, **maintain the established design**:\n\n### Headers\n```jsx\n<View style={styles.header}>\n  <Text style={styles.headerTitle}>Screen Title</Text>\n  <Text style={styles.headerSubtitle}>Subtitle text</Text>\n</View>\n\nstyles.header: {\n  backgroundColor: '#4F46E5',\n  padding: 24,\n  paddingTop: 32,\n}\n```\n\n### Cards\n```jsx\n<View style={styles.card}>\n  {/* Content */}\n</View>\n\nstyles.card: {\n  backgroundColor: '#FFFFFF',\n  marginHorizontal: 16,\n  marginTop: 16,\n  padding: 20,\n  borderRadius: 12,\n  shadowColor: '#000',\n  shadowOffset: { width: 0, height: 1 },\n  shadowOpacity: 0.08,\n  shadowRadius: 3,\n  elevation: 2,\n}\n```\n\n### Buttons\n```jsx\n<TouchableOpacity style={styles.primaryButton}>\n  <Text style={styles.primaryButtonText}>Action</Text>\n</TouchableOpacity>\n\nstyles.primaryButton: {\n  backgroundColor: '#4F46E5',\n  paddingVertical: 16,\n  paddingHorizontal: 32,\n  borderRadius: 12,\n  alignItems: 'center',\n}\n```\n\n---\n\n## 🔐 Security Features\n\nYour app includes:\n- ✅ Row Level Security (RLS) in database schema\n- ✅ JWT authentication in backend\n- ✅ Password hashing via Supabase Auth\n- ✅ API rate limiting\n- ✅ Input validation with Zod\n- ✅ CORS protection\n- ✅ Secure secret management via Replit Secrets\n\n---\n\n## 📦 Deployment Configuration\n\n✅ **Deployment is configured!**\n\nWhen you're ready to publish:\n1. Click the \"Deploy\" button in Replit\n2. Your app will build and deploy automatically\n3. Frontend will be available on port 5000\n4. Backend API will run on port 3001\n\n---\n\n## 🎊 Summary\n\n**Your QuickLoan app is beautifully designed and well-architected!**\n\n✅ **Completed**: 5/9 screens (Home, Calculator, Apply, Status, Profile)  \n✅ **Backend**: 100% complete, waiting for database connection  \n✅ **Design**: Modern, professional, consistent  \n⏳ **Remaining**: 4 screens (Login, Register, Admin, Rider)  \n\nThe foundation is **rock solid** - clean code, beautiful UI, professional architecture. Once you provide the Supabase credentials, we can complete the authentication and role-specific dashboards!\n\n---\n\n## 📞 Need Help?\n\nCurrent waiting items:\n1. Supabase credentials (I've asked for these via Replit Secrets)\n2. Once provided, I'll help you:\n   - Set up the database\n   - Complete the login/register screens\n   - Build the admin dashboard\n   - Create the rider portal\n\nYour app is looking **amazing**! 🚀\n","size_bytes":8283},"backend/src/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from 'express';\nimport { supabase } from '../config/supabase';\n\nexport interface AuthRequest extends Request {\n  user?: {\n    id: string;\n    email: string;\n    roles: string[];\n  };\n}\n\nexport const authenticate = async (\n  req: AuthRequest,\n  res: Response,\n  next: NextFunction\n) => {\n  try {\n    const authHeader = req.headers.authorization;\n\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return res.status(401).json({ error: 'Missing or invalid authorization header' });\n    }\n\n    const token = authHeader.split(' ')[1];\n\n    const { data: { user }, error } = await supabase.auth.getUser(token);\n\n    if (error || !user) {\n      return res.status(401).json({ error: 'Invalid or expired token' });\n    }\n\n    const { data: userRoles, error: rolesError } = await supabase\n      .from('user_roles')\n      .select('roles(name)')\n      .eq('user_id', user.id);\n\n    if (rolesError) {\n      return res.status(500).json({ error: 'Failed to fetch user roles' });\n    }\n\n    const roles = userRoles?.map((ur: any) => ur.roles.name) || [];\n\n    req.user = {\n      id: user.id,\n      email: user.email!,\n      roles\n    };\n\n    next();\n  } catch (error) {\n    console.error('Authentication error:', error);\n    res.status(401).json({ error: 'Authentication failed' });\n  }\n};\n\nexport const requireRole = (...allowedRoles: string[]) => {\n  return (req: AuthRequest, res: Response, next: NextFunction): void => {\n    if (!req.user) {\n      res.status(401).json({ error: 'Not authenticated' });\n      return;\n    }\n\n    const hasRole = req.user.roles.some(role => allowedRoles.includes(role));\n\n    if (!hasRole) {\n      res.status(403).json({ \n        error: 'Insufficient permissions',\n        required: allowedRoles,\n        current: req.user.roles\n      });\n      return;\n    }\n\n    next();\n  };\n};\n","size_bytes":1857},"backend/src/routes/rider.ts":{"content":"import { Router } from 'express';\nimport * as riderController from '../controllers/riderController';\nimport { authenticate, requireRole } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.use(authenticate);\nrouter.use(requireRole('rider'));\n\nrouter.get('/assignments', riderController.getAssignments);\nrouter.put('/assignments/:id/status', riderController.updateAssignmentStatus);\nrouter.put('/availability', riderController.updateAvailability);\nrouter.get('/metrics', riderController.getMetrics);\n\nexport default router;\n","size_bytes":533},"SETUP_GUIDE.md":{"content":"# QuickLoan Setup Guide\n##\n## 🎉 What's Been Built\n\nI've successfully transformed your simple loan app into a **comprehensive full-stack PERN + Supabase loan management system** with multi-role authentication. Here's what's complete:\n\n### ✅ Backend Infrastructure (100% Complete)\n- **Express API server** with TypeScript\n- **Complete database schema** with Row Level Security (RLS) policies\n- **Authentication system** using Supabase Auth + JWT\n- **Role-based access control** (Borrower, Admin, Rider)\n- **All API endpoints** for all three user roles:\n  - Authentication (register, login, logout, me)\n  - Borrower loans (create, list, view, upload documents)\n  - Admin (loan management, rider CRUD, assignments, metrics)\n  - Rider (assignments, status updates, availability, metrics)\n\n### ✅ Frontend Infrastructure (60% Complete)\n- **Supabase client integration**\n- **Authentication context** with backend API calls\n- **API client wrapper** with automatic token handling\n- **Environment configuration**\n\n### ⏳ Still Needed (Frontend UI)\n- Auth screens (login, register)\n- Admin dashboard UI\n- Rider interface UI\n- Update borrower screens to use backend APIs\n\n---\n\n## 🚀 Quick Start (Critical First Steps)\n\n### 1. Create Supabase Project\n\n1. Go to [supabase.com](https://supabase.com) and create a free account\n2. Create a new project\n3. Wait for the project to be ready (2-3 minutes)\n\n### 2. Set Up Database Schema\n\n1. In your Supabase project, go to **SQL Editor**\n2. Open the `schema.sql` file from this project\n3. Copy **ALL** the content (it's comprehensive!)\n4. Paste into Supabase SQL Editor\n5. Click \"Run\" to execute\n\nThis creates:\n- All tables (users, roles, loans, riders, documents, etc.)\n- Row Level Security policies for data protection\n- Helper functions for role checking\n- Indexes for performance\n\n### 3. Get Supabase Credentials\n\nIn Supabase project settings:\n1. Go to **Settings** → **API**\n2. Copy these values:\n   - **Project URL** (looks like: `https://xxxxx.supabase.co`)\n   - **anon public** key (long string starting with `eyJ...`)\n   - **service_role** key (KEEP THIS SECRET!)\n\n### 4. Configure Backend\n\n1. Open `backend/.env`\n2. Fill in the values:\n```env\nPORT=3001\nNODE_ENV=development\n\n# Paste your Supabase credentials here:\nSUPABASE_URL=https://xxxxx.supabase.co\nSUPABASE_SERVICE_KEY=your_service_role_key_here\nSUPABASE_ANON_KEY=your_anon_key_here\n\n# Generate a random string for JWT_SECRET (or use this one for testing):\nJWT_SECRET=your_super_secret_jwt_key_change_in_production_12345\n\nFRONTEND_URL=http://localhost:5000\nMAX_FILE_SIZE=10485760\nALLOWED_FILE_TYPES=image/jpeg,image/png,image/jpg,application/pdf\n```\n\n### 5. Configure Frontend\n\n1. Open `frontend/.env`\n2. Fill in the values:\n```env\n# Use the SAME Supabase URL and anon key:\nEXPO_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co\nEXPO_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here\n\n# Backend API URL (for local Replit):\nEXPO_PUBLIC_API_URL=http://localhost:3001/api\n```\n\n### 6. Restart the Workflows\n\nBoth workflows are configured:\n- **frontend** - Expo web on port 5000\n- **backend** - Express API on port 3001\n\nThey should restart automatically, but if not, click the restart button in Replit.\n\n---\n\n## 👤 Create Your Admin User\n\nAfter the backend starts successfully:\n\n### Option A: Sign Up Through App (Recommended)\n1. Wait for both workflows to be running\n2. Open the app and sign up with your email\n3. Find your user ID in Supabase:\n   - Go to **Authentication** → **Users**\n   - Copy your user's ID\n4. Run this SQL in Supabase SQL Editor:\n```sql\n-- Replace 'YOUR_USER_ID_HERE' with the actual ID\nINSERT INTO user_roles (user_id, role_id)\nSELECT \n    'YOUR_USER_ID_HERE',\n    (SELECT id FROM roles WHERE name = 'admin');\n```\n\n### Option B: Manually Create Admin\n1. In Supabase, go to **Authentication** → **Users**\n2. Click \"Add User\"\n3. Email: `kcbiron79@gmail.com`\n4. Password: `almonte17`\n5. Click \"Create\"\n6. Copy the generated user ID\n7. Run the SQL above with that ID\n\n---\n\n## 🏗️ System Architecture\n\n### Database Schema\n- **users** - User profiles (name, phone, email)\n- **roles** - System roles (borrower, admin, rider)\n- **user_roles** - User-to-role mapping (many-to-many)\n- **borrower_profiles** - Extended borrower data\n- **riders** - Rider profiles with zones and metrics\n- **loans** - Loan applications and status\n- **loan_documents** - Document uploads\n- **loan_status_history** - Audit trail\n- **rider_assignments** - Loan-to-rider assignments\n- **notifications** - User notifications\n\n### Security Model\n- **RLS Policies**: Every table has comprehensive Row Level Security\n- **Service Role**: Backend uses service role for privileged operations\n- **Anon Role**: Frontend uses anon key for user authentication\n- **Role Checking**: Helper function `has_role()` for policy enforcement\n\n### API Structure\n```\n/api/auth/*       - Authentication (public)\n/api/loans/*      - Borrower loans (requires auth)\n/api/admin/*      - Admin operations (requires admin role)\n/api/rider/*      - Rider operations (requires rider role)\n```\n\n---\n\n## 📋 What Each Role Can Do\n\n### 🙋 Borrower (Default for all new users)\n- Apply for loans\n- Upload required documents (ID, proof of income, etc.)\n- Track loan application status\n- View loan history\n- Use loan calculator\n- Receive notifications\n\n**API Endpoints:**\n- `GET /api/loans` - View my loans\n- `POST /api/loans` - Apply for loan\n- `GET /api/loans/:id` - View loan details\n- `POST /api/loans/:id/documents` - Upload documents\n\n### 👔 Admin (kcbiron79@gmail.com)\n- Review all loan applications\n- Approve/reject loans\n- Create and manage riders\n- Assign riders to loan verifications\n- View system metrics and analytics\n- Manage all users\n\n**API Endpoints:**\n- `GET /api/admin/loans` - View all loans\n- `PUT /api/admin/loans/:id` - Update loan status\n- `POST /api/admin/loans/:id/assign` - Assign rider\n- `GET /api/admin/riders` - List all riders\n- `POST /api/admin/riders` - Create new rider\n- `GET /api/admin/metrics` - System analytics\n\n### 🏍️ Rider (Field Verification Agent)\n- View assigned loan verifications\n- Update verification status\n- Upload verification documents\n- Manage availability (active/inactive)\n- View personal metrics\n\n**API Endpoints:**\n- `GET /api/rider/assignments` - My assignments\n- `PUT /api/rider/assignments/:id/status` - Update status\n- `PUT /api/rider/availability` - Set active/inactive\n- `GET /api/rider/metrics` - My performance\n\n---\n\n## 🧪 Testing the System\n\n### 1. Test Authentication\n```bash\n# Register a new borrower\ncurl -X POST http://localhost:3001/api/auth/register \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"test@example.com\",\n    \"password\": \"password123\",\n    \"full_name\": \"Test User\",\n    \"phone\": \"+1234567890\"\n  }'\n```\n\n### 2. Test Loan Application\n```bash\n# Create a loan (requires auth token)\ncurl -X POST http://localhost:3001/api/loans \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer YOUR_TOKEN_HERE\" \\\n  -d '{\n    \"amount\": 50000,\n    \"purpose\": \"Business expansion\",\n    \"loan_type\": \"business\",\n    \"term_months\": 12\n  }'\n```\n\n### 3. Test Admin Operations\n```bash\n# View all loans (admin only)\ncurl -X GET http://localhost:3001/api/admin/loans \\\n  -H \"Authorization: Bearer ADMIN_TOKEN_HERE\"\n```\n\n---\n\n## 🎨 Next Steps: Frontend UI\n\nThe backend is 100% complete and ready to use. To make the system fully functional, you need to build:\n\n### 1. Authentication Screens\n- **Login screen**: Email/password form, call backend API\n- **Register screen**: Sign up form with full name, phone\n- **Role-based routing**: Redirect based on user role after login\n\n### 2. Admin Dashboard\n- **Loan queue**: List of pending loans with approve/reject actions\n- **Rider management**: Create riders, view list, assign to loans\n- **Analytics**: Charts showing loan metrics, approval rates\n- **Loan details**: Modal/screen to review loan applications\n\n### 3. Rider Interface\n- **Assignment list**: Loans assigned to this rider\n- **Status updates**: Mark as in_progress, completed\n- **Document upload**: Add verification photos\n- **Availability toggle**: Active/Inactive switch\n\n### 4. Update Borrower Screens\n- Replace AsyncStorage calls with API calls\n- Connect loan application form to `POST /api/loans`\n- Connect document upload to `POST /api/loans/:id/documents`\n- Fetch loan list from `GET /api/loans`\n\n---\n\n## 📚 Key Files Reference\n\n### Backend\n- `backend/src/index.ts` - Main server setup\n- `backend/src/config/supabase.ts` - Supabase client\n- `backend/src/middleware/auth.ts` - Authentication middleware\n- `backend/src/controllers/authController.ts` - Auth logic\n- `backend/src/controllers/loanController.ts` - Loan operations\n- `backend/src/controllers/adminController.ts` - Admin operations\n- `backend/src/controllers/riderController.ts` - Rider operations\n\n### Frontend\n- `frontend/lib/supabase.ts` - Supabase client\n- `frontend/lib/api.ts` - API client wrapper\n- `frontend/contexts/AuthContext.tsx` - Auth state management\n\n### Database\n- `schema.sql` - Complete database schema with RLS\n\n### Documentation\n- `FEATURES.md` - Detailed feature documentation\n- `replit.md` - Project overview and setup\n- `SETUP_GUIDE.md` - This file\n\n---\n\n## 🔒 Security Features\n\n✅ **Row Level Security (RLS)** - Database-level data isolation\n✅ **Role-based access control** - Only authorized users can access endpoints\n✅ **JWT validation** - Secure token-based authentication\n✅ **Service role separation** - Backend uses privileged keys safely\n✅ **Password hashing** - Supabase Auth handles secure password storage\n✅ **CORS protection** - Only frontend can access backend\n✅ **Rate limiting** - Prevents abuse\n✅ **Environment variables** - Secrets stored securely\n\n---\n\n## 🐛 Troubleshooting\n\n### Backend won't start\n- ✅ **Check**: backend/.env has all Supabase credentials\n- ✅ **Verify**: Schema was run successfully in Supabase\n- ✅ **Look at**: Backend workflow logs for specific error\n\n### Frontend can't connect\n- ✅ **Check**: frontend/.env has correct API URL\n- ✅ **Verify**: Backend is running on port 3001\n- ✅ **Test**: Open http://localhost:3001/api/health in browser\n\n### \"Missing Supabase environment variables\"\n- ✅ **Check**: All three Supabase values in backend/.env\n- ✅ **Restart**: Backend workflow after updating .env\n\n### Authentication fails\n- ✅ **Check**: User was created in Supabase Authentication\n- ✅ **Verify**: User has role assigned via SQL\n- ✅ **Test**: Use Supabase dashboard to confirm user exists\n\n---\n\n## 📈 Deployment (Publishing)\n\nWhen you're ready to deploy to production:\n\n1. **Update environment variables** for production URLs\n2. **Click \"Deploy\" button** in Replit\n3. **Update frontend .env** with deployed backend URL\n4. **Test all endpoints** with production data\n\n---\n\n## ✨ Summary\n\nYou now have a **production-ready loan management backend** with:\n- ✅ Multi-role authentication system\n- ✅ Complete REST API for all operations\n- ✅ Secure database with RLS policies\n- ✅ Comprehensive documentation\n\n**Next:** Build the frontend UI screens to create a complete full-stack application!\n\nIf you have questions or encounter issues, check:\n1. Backend logs in workflow console\n2. Supabase dashboard for database errors\n3. Browser console for frontend errors\n4. This guide's troubleshooting section\n\nHappy coding! 🚀\n","size_bytes":11358},"backend/src/controllers/adminController.ts":{"content":"import { Response } from 'express';\nimport { supabase } from '../config/supabase';\nimport { AppError } from '../middleware/errorHandler';\nimport { AuthRequest } from '../middleware/auth';\n\nexport const getAllLoans = async (req: AuthRequest, res: Response) => {\n  try {\n    const { status } = req.query;\n\n    let query = supabase\n      .from('loans')\n      .select(`\n        *,\n        borrower:users!loans_borrower_id_fkey(full_name, phone, email),\n        rider:riders(id, user:users(full_name))\n      `)\n      .order('applied_at', { ascending: false });\n\n    if (status) {\n      query = query.eq('status', status);\n    }\n\n    const { data, error } = await query;\n\n    if (error) {\n      throw new AppError('Failed to fetch loans', 500);\n    }\n\n    res.json({ loans: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Get all loans error:', error);\n      res.status(500).json({ error: 'Failed to fetch loans' });\n    }\n  }\n};\n\nexport const updateLoanStatus = async (req: AuthRequest, res: Response) => {\n  try {\n    const { id } = req.params;\n    const { status, notes } = req.body;\n\n    const { data, error } = await supabase\n      .from('loans')\n      .update({\n        status,\n        notes,\n        reviewed_at: new Date().toISOString(),\n        reviewed_by: req.user?.id,\n        ...(status === 'approved' && { approved_at: new Date().toISOString() }),\n        ...(status === 'disbursed' && { disbursed_at: new Date().toISOString() }),\n        ...(status === 'closed' && { closed_at: new Date().toISOString() }),\n      })\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to update loan status', 500);\n    }\n\n    res.json({ message: 'Loan status updated', loan: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Update loan status error:', error);\n      res.status(500).json({ error: 'Failed to update loan status' });\n    }\n  }\n};\n\nexport const assignRider = async (req: AuthRequest, res: Response) => {\n  try {\n    const { id } = req.params;\n    const { rider_id } = req.body;\n\n    const { data, error } = await supabase\n      .from('loans')\n      .update({ rider_id })\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) {\n      throw new AppError('Failed to assign rider', 500);\n    }\n\n    await supabase.from('rider_assignments').insert([\n      {\n        rider_id,\n        loan_id: id,\n        assigned_by: req.user?.id,\n        status: 'assigned',\n      }\n    ]);\n\n    res.json({ message: 'Rider assigned successfully', loan: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Assign rider error:', error);\n      res.status(500).json({ error: 'Failed to assign rider' });\n    }\n  }\n};\n\nexport const getAllRiders = async (_req: AuthRequest, res: Response) => {\n  try {\n    const { data, error } = await supabase\n      .from('riders')\n      .select('*, user:users(full_name, phone, email)')\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      throw new AppError('Failed to fetch riders', 500);\n    }\n\n    res.json({ riders: data });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Get riders error:', error);\n      res.status(500).json({ error: 'Failed to fetch riders' });\n    }\n  }\n};\n\nexport const createRider = async (req: AuthRequest, res: Response) => {\n  try {\n    const { email, password, full_name, phone, zone } = req.body;\n\n    const { data: authData, error: authError } = await supabase.auth.admin.createUser({\n      email,\n      password,\n      email_confirm: true,\n    });\n\n    if (authError || !authData.user) {\n      throw new AppError('Failed to create rider account', 500);\n    }\n\n    const { error: userError } = await supabase.from('users').insert([\n      {\n        id: authData.user.id,\n        full_name,\n        phone,\n      }\n    ]);\n\n    if (userError) {\n      await supabase.auth.admin.deleteUser(authData.user.id);\n      throw new AppError('Failed to create user profile', 500);\n    }\n\n    const { data: riderRole } = await supabase\n      .from('roles')\n      .select('id')\n      .eq('name', 'rider')\n      .single();\n\n    if (riderRole) {\n      await supabase.from('user_roles').insert([\n        {\n          user_id: authData.user.id,\n          role_id: riderRole.id,\n        }\n      ]);\n    }\n\n    const { data: riderData, error: riderError } = await supabase\n      .from('riders')\n      .insert([\n        {\n          user_id: authData.user.id,\n          zone,\n          status: 'active',\n        }\n      ])\n      .select()\n      .single();\n\n    if (riderError) {\n      throw new AppError('Failed to create rider profile', 500);\n    }\n\n    res.status(201).json({ message: 'Rider created successfully', rider: riderData });\n  } catch (error) {\n    if (error instanceof AppError) {\n      res.status(error.statusCode).json({ error: error.message });\n    } else {\n      console.error('Create rider error:', error);\n      res.status(500).json({ error: 'Failed to create rider' });\n    }\n  }\n};\n\nexport const getMetrics = async (_req: AuthRequest, res: Response) => {\n  try {\n    const { data: loans } = await supabase.from('loans').select('status, amount');\n    const { data: riders } = await supabase.from('riders').select('status');\n\n    const metrics = {\n      total_loans: loans?.length || 0,\n      pending_loans: loans?.filter(l => l.status === 'pending').length || 0,\n      approved_loans: loans?.filter(l => l.status === 'approved').length || 0,\n      total_disbursed: loans?.filter(l => l.status === 'disbursed')\n        .reduce((sum, l) => sum + Number(l.amount), 0) || 0,\n      active_riders: riders?.filter(r => r.status === 'active').length || 0,\n    };\n\n    res.json({ metrics });\n  } catch (error) {\n    console.error('Get metrics error:', error);\n    res.status(500).json({ error: 'Failed to fetch metrics' });\n  }\n};\n","size_bytes":6219},"frontend/app/index.tsx":{"content":"import React from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  ScrollView,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { loanProducts } from '../utils/loanProducts';\nimport { LoanProduct } from '../types';\n\nexport default function HomeScreen() {\n  const renderLoanProduct = ({ item }: { item: LoanProduct }) => (\n    <TouchableOpacity\n      style={styles.productCard}\n      onPress={() => router.push('/calculator')}\n    >\n      <View style={styles.iconContainer}>\n        <Text style={styles.icon}>{item.icon}</Text>\n      </View>\n      <View style={styles.productInfo}>\n        <Text style={styles.productName}>{item.name}</Text>\n        <Text style={styles.productDescription}>{item.description}</Text>\n        <View style={styles.productDetails}>\n          <Text style={styles.detailText}>\n            Rate: {item.interestRate}% APR\n          </Text>\n          <Text style={styles.detailText}>\n            Up to ${item.maxAmount.toLocaleString()}\n          </Text>\n        </View>\n      </View>\n    </TouchableOpacity>\n  );\n\n  return (\n    <ScrollView style={styles.container}>\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>Welcome to QuickLoan</Text>\n        <Text style={styles.headerSubtitle}>\n          Find the perfect loan for your needs\n        </Text>\n      </View>\n\n      <View style={styles.statsContainer}>\n        <View style={styles.statBox}>\n          <Text style={styles.statValue}>$500M+</Text>\n          <Text style={styles.statLabel}>Loans Disbursed</Text>\n        </View>\n        <View style={styles.statBox}>\n          <Text style={styles.statValue}>50K+</Text>\n          <Text style={styles.statLabel}>Happy Customers</Text>\n        </View>\n        <View style={styles.statBox}>\n          <Text style={styles.statValue}>4.8★</Text>\n          <Text style={styles.statLabel}>Rating</Text>\n        </View>\n      </View>\n\n      <Text style={styles.sectionTitle}>Our Loan Products</Text>\n      \n      <FlatList\n        data={loanProducts}\n        renderItem={renderLoanProduct}\n        keyExtractor={(item) => item.id}\n        scrollEnabled={false}\n      />\n\n      <View style={styles.ctaContainer}>\n        <Text style={styles.ctaTitle}>Ready to apply?</Text>\n        <TouchableOpacity\n          style={styles.ctaButton}\n          onPress={() => router.push('/apply')}\n        >\n          <Text style={styles.ctaButtonText}>Start Application</Text>\n        </TouchableOpacity>\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  header: {\n    backgroundColor: '#4F46E5',\n    padding: 24,\n    paddingTop: 32,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#FFFFFF',\n    marginBottom: 8,\n  },\n  headerSubtitle: {\n    fontSize: 16,\n    color: '#E0E7FF',\n  },\n  statsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    padding: 20,\n    backgroundColor: '#FFFFFF',\n    marginHorizontal: 16,\n    marginTop: -20,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  statBox: {\n    alignItems: 'center',\n  },\n  statValue: {\n    fontSize: 22,\n    fontWeight: 'bold',\n    color: '#4F46E5',\n  },\n  statLabel: {\n    fontSize: 12,\n    color: '#6B7280',\n    marginTop: 4,\n  },\n  sectionTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginHorizontal: 16,\n    marginTop: 24,\n    marginBottom: 16,\n  },\n  productCard: {\n    flexDirection: 'row',\n    backgroundColor: '#FFFFFF',\n    marginHorizontal: 16,\n    marginBottom: 12,\n    padding: 16,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.08,\n    shadowRadius: 3,\n    elevation: 2,\n  },\n  iconContainer: {\n    width: 60,\n    height: 60,\n    borderRadius: 30,\n    backgroundColor: '#EEF2FF',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: 16,\n  },\n  icon: {\n    fontSize: 32,\n  },\n  productInfo: {\n    flex: 1,\n  },\n  productName: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 4,\n  },\n  productDescription: {\n    fontSize: 14,\n    color: '#6B7280',\n    marginBottom: 8,\n  },\n  productDetails: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  detailText: {\n    fontSize: 13,\n    color: '#4F46E5',\n    fontWeight: '600',\n  },\n  ctaContainer: {\n    padding: 24,\n    alignItems: 'center',\n    marginTop: 16,\n  },\n  ctaTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 16,\n  },\n  ctaButton: {\n    backgroundColor: '#4F46E5',\n    paddingHorizontal: 32,\n    paddingVertical: 16,\n    borderRadius: 12,\n    width: '100%',\n    alignItems: 'center',\n  },\n  ctaButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":4959},"frontend/app/status.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  RefreshControl,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { api } from '../lib/api';\nimport { useAuth } from '../contexts/AuthContext';\n\ninterface Loan {\n  id: string;\n  amount: number;\n  term_months: number;\n  status: string;\n  purpose: string;\n  loan_type: string;\n  created_at: string;\n}\n\nexport default function StatusScreen() {\n  const { user, isLoading: authLoading } = useAuth();\n  const [loans, setLoans] = useState<Loan[]>([]);\n  const [refreshing, setRefreshing] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const loadLoans = async () => {\n    if (!user) {\n      setLoans([]);\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const data = await api.get('/loans');\n      setLoans(data.loans || []);\n    } catch (error: any) {\n      Alert.alert('Error', 'Failed to load loans. Please try again.');\n      console.error('Error loading loans:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!authLoading) {\n      loadLoans();\n    }\n  }, [user, authLoading]);\n\n  const onRefresh = async () => {\n    setRefreshing(true);\n    await loadLoans();\n    setRefreshing(false);\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status.toLowerCase()) {\n      case 'approved':\n      case 'disbursed':\n        return '#10B981';\n      case 'rejected':\n        return '#EF4444';\n      case 'under_review':\n      case 'reviewing':\n        return '#F59E0B';\n      default:\n        return '#6B7280';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status.toLowerCase()) {\n      case 'approved':\n      case 'disbursed':\n        return '✓';\n      case 'rejected':\n        return '✕';\n      case 'under_review':\n      case 'reviewing':\n        return '⟳';\n      default:\n        return '⋯';\n    }\n  };\n\n  const getLoanTypeName = (type: string) => {\n    const typeMap: Record<string, string> = {\n      'personal': 'Personal Loan',\n      'business': 'Business Loan',\n      'education': 'Education Loan',\n    };\n    return typeMap[type] || type;\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n    });\n  };\n\n  const renderLoan = ({ item }: { item: Loan }) => (\n    <View style={styles.applicationCard}>\n      <View style={styles.cardHeader}>\n        <View>\n          <Text style={styles.productName}>{getLoanTypeName(item.loan_type)}</Text>\n          <Text style={styles.dateText}>{formatDate(item.created_at)}</Text>\n        </View>\n        <View\n          style={[\n            styles.statusBadge,\n            { backgroundColor: getStatusColor(item.status) },\n          ]}\n        >\n          <Text style={styles.statusIcon}>{getStatusIcon(item.status)}</Text>\n          <Text style={styles.statusText}>\n            {item.status.replace('_', ' ').charAt(0).toUpperCase() + item.status.replace('_', ' ').slice(1)}\n          </Text>\n        </View>\n      </View>\n\n      <View style={styles.cardBody}>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Loan Amount</Text>\n          <Text style={styles.detailValue}>\n            ${item.amount.toLocaleString()}\n          </Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Term</Text>\n          <Text style={styles.detailValue}>{item.term_months} months</Text>\n        </View>\n        <View style={styles.detailRow}>\n          <Text style={styles.detailLabel}>Purpose</Text>\n          <Text style={styles.detailValue}>{item.purpose}</Text>\n        </View>\n      </View>\n\n      {item.status === 'pending' && (\n        <View style={styles.cardFooter}>\n          <Text style={styles.footerText}>\n            ⏱️ Estimated processing time: 2-3 business days\n          </Text>\n        </View>\n      )}\n\n      {item.status === 'under_review' && (\n        <View style={[styles.cardFooter, { backgroundColor: '#FEF3C7' }]}>\n          <Text style={[styles.footerText, { color: '#92400E' }]}>\n            📋 Under review - We may contact you for additional information\n          </Text>\n        </View>\n      )}\n\n      {item.status === 'approved' && (\n        <View style={[styles.cardFooter, { backgroundColor: '#D1FAE5' }]}>\n          <Text style={[styles.footerText, { color: '#065F46' }]}>\n            🎉 Congratulations! Your loan has been approved\n          </Text>\n        </View>\n      )}\n\n      {item.status === 'rejected' && (\n        <View style={[styles.cardFooter, { backgroundColor: '#FEE2E2' }]}>\n          <Text style={[styles.footerText, { color: '#991B1B' }]}>\n            Unfortunately, your application was not approved at this time\n          </Text>\n        </View>\n      )}\n    </View>\n  );\n\n  if (authLoading || loading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"large\" color=\"#4F46E5\" />\n        <Text style={styles.loadingText}>Loading loans...</Text>\n      </View>\n    );\n  }\n\n  if (!user) {\n    return (\n      <View style={styles.emptyState}>\n        <Text style={styles.emptyIcon}>🔒</Text>\n        <Text style={styles.emptyTitle}>Sign In Required</Text>\n        <Text style={styles.emptyText}>\n          Please sign in to view your loan applications\n        </Text>\n        <TouchableOpacity\n          style={styles.signInButton}\n          onPress={() => router.push('/login')}\n        >\n          <Text style={styles.signInButtonText}>Sign In</Text>\n        </TouchableOpacity>\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>My Loan Applications</Text>\n        <Text style={styles.headerSubtitle}>\n          Track the status of your loan applications\n        </Text>\n      </View>\n\n      {loans.length === 0 ? (\n        <View style={styles.emptyState}>\n          <Text style={styles.emptyIcon}>📋</Text>\n          <Text style={styles.emptyTitle}>No Applications Yet</Text>\n          <Text style={styles.emptyText}>\n            You haven't submitted any loan applications yet. Start your journey by\n            applying for a loan!\n          </Text>\n          <TouchableOpacity\n            style={styles.applyButton}\n            onPress={() => router.push('/apply')}\n          >\n            <Text style={styles.applyButtonText}>Apply for a Loan</Text>\n          </TouchableOpacity>\n        </View>\n      ) : (\n        <FlatList\n          data={loans}\n          renderItem={renderLoan}\n          keyExtractor={(item) => item.id}\n          contentContainerStyle={styles.listContainer}\n          refreshControl={\n            <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n          }\n        />\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  header: {\n    backgroundColor: '#4F46E5',\n    padding: 24,\n    paddingTop: 32,\n  },\n  headerTitle: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#FFFFFF',\n    marginBottom: 8,\n  },\n  headerSubtitle: {\n    fontSize: 16,\n    color: '#E0E7FF',\n  },\n  listContainer: {\n    padding: 16,\n  },\n  applicationCard: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 12,\n    marginBottom: 16,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  cardHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#F3F4F6',\n  },\n  productName: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#111827',\n  },\n  dateText: {\n    fontSize: 13,\n    color: '#6B7280',\n    marginTop: 4,\n  },\n  statusBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 16,\n  },\n  statusIcon: {\n    color: '#FFFFFF',\n    marginRight: 4,\n    fontSize: 14,\n  },\n  statusText: {\n    color: '#FFFFFF',\n    fontSize: 13,\n    fontWeight: 'bold',\n  },\n  cardBody: {\n    padding: 16,\n  },\n  detailRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 8,\n  },\n  detailLabel: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  detailValue: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#111827',\n  },\n  cardFooter: {\n    backgroundColor: '#F0F9FF',\n    padding: 12,\n    borderBottomLeftRadius: 12,\n    borderBottomRightRadius: 12,\n  },\n  footerText: {\n    fontSize: 13,\n    color: '#075985',\n    textAlign: 'center',\n  },\n  emptyState: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 32,\n  },\n  emptyIcon: {\n    fontSize: 64,\n    marginBottom: 16,\n  },\n  emptyTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginBottom: 8,\n  },\n  emptyText: {\n    fontSize: 16,\n    color: '#6B7280',\n    textAlign: 'center',\n    marginBottom: 24,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#F9FAFB',\n  },\n  loadingText: {\n    marginTop: 12,\n    fontSize: 16,\n    color: '#6B7280',\n  },\n  signInButton: {\n    backgroundColor: '#4F46E5',\n    paddingHorizontal: 32,\n    paddingVertical: 16,\n    borderRadius: 12,\n    marginTop: 16,\n  },\n  signInButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  applyButton: {\n    backgroundColor: '#4F46E5',\n    paddingHorizontal: 32,\n    paddingVertical: 16,\n    borderRadius: 12,\n    marginTop: 16,\n  },\n  applyButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":9877},"backend/src/config/index.ts":{"content":"import dotenv from 'dotenv';\n\ndotenv.config();\n\nexport const config = {\n  port: process.env.PORT || 3001,\n  nodeEnv: process.env.NODE_ENV || 'development',\n  supabaseUrl: process.env.SUPABASE_URL || '',\n  supabaseServiceKey: process.env.SUPABASE_SERVICE_KEY || '',\n  supabaseAnonKey: process.env.SUPABASE_ANON_KEY || '',\n  jwtSecret: process.env.JWT_SECRET || '',\n  frontendUrl: process.env.FRONTEND_URL || 'http://localhost:5000',\n  maxFileSize: parseInt(process.env.MAX_FILE_SIZE || '10485760', 10),\n  allowedFileTypes: (process.env.ALLOWED_FILE_TYPES || '').split(','),\n};\n\nexport default config;\n","size_bytes":600},"frontend/lib/api.ts":{"content":"import { supabase } from './supabase';\n\nconst API_URL = process.env.EXPO_PUBLIC_API_URL || 'http://localhost:3001/api';\n\nasync function getAuthHeaders(): Promise<Record<string, string>> {\n  const { data: { session } } = await supabase.auth.getSession();\n  \n  const headers: Record<string, string> = {\n    'Content-Type': 'application/json',\n  };\n\n  if (session?.access_token) {\n    headers['Authorization'] = `Bearer ${session.access_token}`;\n  }\n\n  return headers;\n}\n\nexport const api = {\n  async get(endpoint: string) {\n    const headers = await getAuthHeaders();\n    const response = await fetch(`${API_URL}${endpoint}`, { headers });\n    \n    if (!response.ok) {\n      throw new Error(`API Error: ${response.statusText}`);\n    }\n    \n    return response.json();\n  },\n\n  async post(endpoint: string, data: any) {\n    const headers = await getAuthHeaders();\n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(data),\n    });\n    \n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Request failed');\n    }\n    \n    return response.json();\n  },\n\n  async put(endpoint: string, data: any) {\n    const headers = await getAuthHeaders();\n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'PUT',\n      headers,\n      body: JSON.stringify(data),\n    });\n    \n    if (!response.ok) {\n      throw new Error(`API Error: ${response.statusText}`);\n    }\n    \n    return response.json();\n  },\n\n  async delete(endpoint: string) {\n    const headers = await getAuthHeaders();\n    const response = await fetch(`${API_URL}${endpoint}`, {\n      method: 'DELETE',\n      headers,\n    });\n    \n    if (!response.ok) {\n      throw new Error(`API Error: ${response.statusText}`);\n    }\n    \n    return response.json();\n  },\n};\n\nexport default api;\n","size_bytes":1874},"backend/src/types/index.ts":{"content":"export interface User {\n  id: string;\n  email: string;\n  full_name: string;\n  phone?: string;\n  avatar_url?: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface UserRole {\n  id: string;\n  user_id: string;\n  role_id: string;\n  assigned_at: string;\n}\n\nexport interface Role {\n  id: string;\n  name: 'borrower' | 'admin' | 'rider';\n  description?: string;\n  created_at: string;\n}\n\nexport type EmploymentStatus = 'employed' | 'self_employed' | 'unemployed' | 'retired' | 'student';\n\nexport interface BorrowerProfile {\n  id: string;\n  user_id: string;\n  employment_status?: EmploymentStatus;\n  employer_name?: string;\n  monthly_income?: number;\n  address?: string;\n  city?: string;\n  state?: string;\n  zip_code?: string;\n  documents?: any[];\n  credit_score?: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport type RiderStatus = 'active' | 'inactive' | 'on_leave' | 'suspended';\n\nexport interface Rider {\n  id: string;\n  user_id?: string;\n  status: RiderStatus;\n  zone?: string;\n  max_assignments: number;\n  current_assignments: number;\n  total_completed: number;\n  rating: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport type LoanProductType = 'personal' | 'business' | 'education' | 'home' | 'auto';\nexport type LoanStatus = 'pending' | 'reviewing' | 'approved' | 'rejected' | 'disbursed' | 'active' | 'closed' | 'defaulted';\n\nexport interface Loan {\n  id: string;\n  borrower_id: string;\n  rider_id?: string;\n  product_type: LoanProductType;\n  amount: number;\n  term_months: number;\n  interest_rate: number;\n  status: LoanStatus;\n  purpose?: string;\n  applied_at: string;\n  reviewed_at?: string;\n  reviewed_by?: string;\n  approved_at?: string;\n  disbursed_at?: string;\n  closed_at?: string;\n  monthly_payment?: number;\n  total_repayment?: number;\n  notes?: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport type DocumentType = 'id_proof' | 'income_proof' | 'address_proof' | 'bank_statement' | 'other';\n\nexport interface LoanDocument {\n  id: string;\n  loan_id: string;\n  storage_path: string;\n  file_name: string;\n  file_type?: string;\n  file_size?: number;\n  document_type: DocumentType;\n  uploaded_at: string;\n  uploaded_by?: string;\n}\n\nexport interface LoanStatusHistory {\n  id: string;\n  loan_id: string;\n  old_status?: LoanStatus;\n  new_status: LoanStatus;\n  notes?: string;\n  changed_by?: string;\n  changed_at: string;\n}\n\nexport type AssignmentStatus = 'assigned' | 'in_progress' | 'completed' | 'cancelled';\n\nexport interface RiderAssignment {\n  id: string;\n  rider_id: string;\n  loan_id: string;\n  status: AssignmentStatus;\n  assigned_at: string;\n  assigned_by?: string;\n  completed_at?: string;\n  notes?: string;\n}\n\nexport type NotificationType = 'loan_status' | 'assignment' | 'system' | 'reminder';\n\nexport interface Notification {\n  id: string;\n  user_id: string;\n  type: NotificationType;\n  title: string;\n  message: string;\n  read: boolean;\n  related_loan_id?: string;\n  created_at: string;\n}\n\nexport interface AuthRequest extends Request {\n  user?: {\n    id: string;\n    email: string;\n    roles: string[];\n  };\n}\n","size_bytes":3082},"frontend/app/rider.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  ActivityIndicator,\n  Alert,\n  RefreshControl,\n  Switch,\n} from 'react-native';\nimport { router } from 'expo-router';\nimport { api } from '../lib/api';\nimport { useAuth } from '../contexts/AuthContext';\nimport { Ionicons } from '@expo/vector-icons';\n\ninterface Assignment {\n  id: string;\n  loan_id: string;\n  status: string;\n  assigned_at: string;\n  completed_at?: string;\n  loans?: {\n    id: string;\n    amount: number;\n    loan_type: string;\n    purpose: string;\n    users?: {\n      full_name: string;\n      email: string;\n      phone: string;\n    };\n  };\n}\n\ninterface RiderMetrics {\n  total_assignments: number;\n  completed_assignments: number;\n  pending_assignments: number;\n  completion_rate: number;\n}\n\nexport default function RiderPortal() {\n  const { user, hasRole } = useAuth();\n  const [activeTab, setActiveTab] = useState<'assignments' | 'metrics'>('assignments');\n  const [assignments, setAssignments] = useState<Assignment[]>([]);\n  const [metrics, setMetrics] = useState<RiderMetrics | null>(null);\n  const [isActive, setIsActive] = useState(true);\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n\n  useEffect(() => {\n    if (!hasRole('rider')) {\n      Alert.alert('Access Denied', 'You do not have rider privileges');\n      router.back();\n      return;\n    }\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      if (activeTab === 'assignments') {\n        const data = await api.get('/rider/assignments');\n        setAssignments(data.assignments || []);\n      } else if (activeTab === 'metrics') {\n        const data = await api.get('/rider/metrics');\n        setMetrics(data);\n      }\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to load data');\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n\n  useEffect(() => {\n    setLoading(true);\n    loadData();\n  }, [activeTab]);\n\n  const onRefresh = async () => {\n    setRefreshing(true);\n    await loadData();\n  };\n\n  const updateAssignmentStatus = async (assignmentId: string, newStatus: string) => {\n    try {\n      await api.put(`/rider/assignments/${assignmentId}/status`, {\n        status: newStatus,\n      });\n      Alert.alert('Success', 'Assignment status updated successfully');\n      loadData();\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to update assignment status');\n    }\n  };\n\n  const toggleAvailability = async (value: boolean) => {\n    try {\n      await api.put('/rider/availability', { is_active: value });\n      setIsActive(value);\n      Alert.alert(\n        'Success',\n        value ? 'You are now active and can receive assignments' : 'You are now inactive'\n      );\n    } catch (error: any) {\n      Alert.alert('Error', error.message || 'Failed to update availability');\n      setIsActive(!value);\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status.toLowerCase()) {\n      case 'completed':\n        return '#10B981';\n      case 'in_progress':\n        return '#F59E0B';\n      case 'assigned':\n        return '#6B7280';\n      default:\n        return '#9CA3AF';\n    }\n  };\n\n  const renderAssignmentCard = (assignment: Assignment) => {\n    const loan = assignment.loans;\n    if (!loan) return null;\n\n    return (\n      <View key={assignment.id} style={styles.card}>\n        <View style={styles.cardHeader}>\n          <View style={{ flex: 1 }}>\n            <Text style={styles.cardTitle}>\n              {loan.users?.full_name || 'Unknown Borrower'}\n            </Text>\n            <Text style={styles.cardSubtitle}>{loan.users?.email}</Text>\n          </View>\n          <View\n            style={[\n              styles.statusBadge,\n              { backgroundColor: getStatusColor(assignment.status) },\n            ]}\n          >\n            <Text style={styles.statusText}>\n              {assignment.status.replace('_', ' ').toUpperCase()}\n            </Text>\n          </View>\n        </View>\n\n        <View style={styles.cardBody}>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Loan Amount:</Text>\n            <Text style={styles.detailValue}>${loan.amount.toLocaleString()}</Text>\n          </View>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Loan Type:</Text>\n            <Text style={styles.detailValue}>{loan.loan_type}</Text>\n          </View>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Purpose:</Text>\n            <Text style={styles.detailValue} numberOfLines={2}>\n              {loan.purpose}\n            </Text>\n          </View>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Contact:</Text>\n            <Text style={styles.detailValue}>{loan.users?.phone || 'N/A'}</Text>\n          </View>\n          <View style={styles.detailRow}>\n            <Text style={styles.detailLabel}>Assigned:</Text>\n            <Text style={styles.detailValue}>\n              {new Date(assignment.assigned_at).toLocaleDateString()}\n            </Text>\n          </View>\n        </View>\n\n        {assignment.status === 'assigned' && (\n          <TouchableOpacity\n            style={styles.actionButton}\n            onPress={() => updateAssignmentStatus(assignment.id, 'in_progress')}\n          >\n            <Text style={styles.actionButtonText}>Start Verification</Text>\n          </TouchableOpacity>\n        )}\n\n        {assignment.status === 'in_progress' && (\n          <TouchableOpacity\n            style={[styles.actionButton, { backgroundColor: '#10B981' }]}\n            onPress={() => updateAssignmentStatus(assignment.id, 'completed')}\n          >\n            <Text style={styles.actionButtonText}>Mark as Completed</Text>\n          </TouchableOpacity>\n        )}\n\n        {assignment.status === 'completed' && assignment.completed_at && (\n          <View style={styles.completedBanner}>\n            <Ionicons name=\"checkmark-circle\" size={20} color=\"#065F46\" />\n            <Text style={styles.completedText}>\n              Completed on {new Date(assignment.completed_at).toLocaleDateString()}\n            </Text>\n          </View>\n        )}\n      </View>\n    );\n  };\n\n  const renderMetrics = () => {\n    if (!metrics) return null;\n\n    return (\n      <View style={styles.metricsContainer}>\n        <View style={styles.metricCard}>\n          <Text style={styles.metricValue}>{metrics.total_assignments}</Text>\n          <Text style={styles.metricLabel}>Total Assignments</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={[styles.metricValue, { color: '#10B981' }]}>\n            {metrics.completed_assignments}\n          </Text>\n          <Text style={styles.metricLabel}>Completed</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={[styles.metricValue, { color: '#F59E0B' }]}>\n            {metrics.pending_assignments}\n          </Text>\n          <Text style={styles.metricLabel}>Pending</Text>\n        </View>\n        <View style={styles.metricCard}>\n          <Text style={[styles.metricValue, { color: '#4F46E5' }]}>\n            {(metrics.completion_rate * 100).toFixed(0)}%\n          </Text>\n          <Text style={styles.metricLabel}>Completion Rate</Text>\n        </View>\n      </View>\n    );\n  };\n\n  if (!hasRole('rider')) {\n    return null;\n  }\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>\n          <Ionicons name=\"arrow-back\" size={24} color=\"#FFFFFF\" />\n        </TouchableOpacity>\n        <Text style={styles.headerTitle}>Rider Portal</Text>\n      </View>\n\n      <View style={styles.availabilityBar}>\n        <View style={{ flex: 1 }}>\n          <Text style={styles.availabilityLabel}>Availability Status</Text>\n          <Text style={styles.availabilitySubtext}>\n            {isActive\n              ? 'You can receive new assignments'\n              : 'You will not receive new assignments'}\n          </Text>\n        </View>\n        <Switch\n          value={isActive}\n          onValueChange={toggleAvailability}\n          trackColor={{ false: '#D1D5DB', true: '#A5B4FC' }}\n          thumbColor={isActive ? '#4F46E5' : '#f4f3f4'}\n        />\n      </View>\n\n      <View style={styles.tabBar}>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'assignments' && styles.tabActive]}\n          onPress={() => setActiveTab('assignments')}\n        >\n          <Text\n            style={[\n              styles.tabText,\n              activeTab === 'assignments' && styles.tabTextActive,\n            ]}\n          >\n            Assignments\n          </Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'metrics' && styles.tabActive]}\n          onPress={() => setActiveTab('metrics')}\n        >\n          <Text\n            style={[styles.tabText, activeTab === 'metrics' && styles.tabTextActive]}\n          >\n            Metrics\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {loading ? (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color=\"#4F46E5\" />\n        </View>\n      ) : (\n        <ScrollView\n          style={styles.content}\n          refreshControl={\n            <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n          }\n        >\n          {activeTab === 'assignments' && (\n            <>\n              {assignments.length === 0 ? (\n                <View style={styles.emptyState}>\n                  <Ionicons name=\"bicycle-outline\" size={64} color=\"#9CA3AF\" />\n                  <Text style={styles.emptyTitle}>No Assignments</Text>\n                  <Text style={styles.emptyText}>\n                    You don't have any assignments yet. Check back later!\n                  </Text>\n                </View>\n              ) : (\n                assignments.map(renderAssignmentCard)\n              )}\n            </>\n          )}\n\n          {activeTab === 'metrics' && renderMetrics()}\n        </ScrollView>\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#F9FAFB',\n  },\n  header: {\n    backgroundColor: '#4F46E5',\n    padding: 20,\n    paddingTop: 40,\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  backButton: {\n    marginRight: 16,\n  },\n  headerTitle: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#FFFFFF',\n  },\n  availabilityBar: {\n    backgroundColor: '#FFFFFF',\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#E5E7EB',\n  },\n  availabilityLabel: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    color: '#111827',\n  },\n  availabilitySubtext: {\n    fontSize: 13,\n    color: '#6B7280',\n    marginTop: 4,\n  },\n  tabBar: {\n    flexDirection: 'row',\n    backgroundColor: '#FFFFFF',\n    borderBottomWidth: 1,\n    borderBottomColor: '#E5E7EB',\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: 16,\n    alignItems: 'center',\n  },\n  tabActive: {\n    borderBottomWidth: 3,\n    borderBottomColor: '#4F46E5',\n  },\n  tabText: {\n    fontSize: 16,\n    color: '#6B7280',\n    fontWeight: '600',\n  },\n  tabTextActive: {\n    color: '#4F46E5',\n  },\n  content: {\n    flex: 1,\n    padding: 16,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  card: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 12,\n    marginBottom: 16,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  cardHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#F3F4F6',\n  },\n  cardTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#111827',\n  },\n  cardSubtitle: {\n    fontSize: 14,\n    color: '#6B7280',\n    marginTop: 4,\n  },\n  statusBadge: {\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 16,\n  },\n  statusText: {\n    color: '#FFFFFF',\n    fontSize: 12,\n    fontWeight: 'bold',\n  },\n  cardBody: {\n    padding: 16,\n  },\n  detailRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 8,\n  },\n  detailLabel: {\n    fontSize: 14,\n    color: '#6B7280',\n  },\n  detailValue: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#111827',\n    flex: 1,\n    textAlign: 'right',\n  },\n  actionButton: {\n    backgroundColor: '#4F46E5',\n    padding: 16,\n    borderBottomLeftRadius: 12,\n    borderBottomRightRadius: 12,\n    alignItems: 'center',\n  },\n  actionButtonText: {\n    color: '#FFFFFF',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  completedBanner: {\n    backgroundColor: '#D1FAE5',\n    padding: 12,\n    borderBottomLeftRadius: 12,\n    borderBottomRightRadius: 12,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 8,\n  },\n  completedText: {\n    fontSize: 14,\n    color: '#065F46',\n    fontWeight: '600',\n  },\n  emptyState: {\n    padding: 40,\n    alignItems: 'center',\n  },\n  emptyTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#111827',\n    marginTop: 16,\n    marginBottom: 8,\n  },\n  emptyText: {\n    fontSize: 16,\n    color: '#6B7280',\n    textAlign: 'center',\n  },\n  metricsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 16,\n  },\n  metricCard: {\n    backgroundColor: '#FFFFFF',\n    borderRadius: 12,\n    padding: 20,\n    width: '47%',\n    alignItems: 'center',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  metricValue: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    color: '#4F46E5',\n    marginBottom: 8,\n  },\n  metricLabel: {\n    fontSize: 14,\n    color: '#6B7280',\n    textAlign: 'center',\n  },\n});\n","size_bytes":14052},"frontend/utils/loanProducts.ts":{"content":"import { LoanProduct } from '../types';\n\nexport const loanProducts: LoanProduct[] = [\n  {\n    id: '1',\n    name: 'Personal Loan',\n    type: 'personal',\n    minAmount: 1000,\n    maxAmount: 50000,\n    interestRate: 8.5,\n    minTerm: 6,\n    maxTerm: 60,\n    description: 'Quick personal loans for any purpose with flexible terms',\n    icon: '💰',\n  },\n  {\n    id: '2',\n    name: 'Business Loan',\n    type: 'business',\n    minAmount: 5000,\n    maxAmount: 500000,\n    interestRate: 6.5,\n    minTerm: 12,\n    maxTerm: 120,\n    description: 'Grow your business with competitive business financing',\n    icon: '🏢',\n  },\n  {\n    id: '3',\n    name: 'Education Loan',\n    type: 'education',\n    minAmount: 2000,\n    maxAmount: 100000,\n    interestRate: 4.5,\n    minTerm: 12,\n    maxTerm: 180,\n    description: 'Invest in your future with low-interest education loans',\n    icon: '🎓',\n  },\n];\n","size_bytes":889},"frontend/types/index.ts":{"content":"export interface LoanProduct {\n  id: string;\n  name: string;\n  type: 'personal' | 'business' | 'education';\n  minAmount: number;\n  maxAmount: number;\n  interestRate: number;\n  minTerm: number;\n  maxTerm: number;\n  description: string;\n  icon: string;\n}\n\nexport interface LoanApplication {\n  id: string;\n  productId: string;\n  productName: string;\n  amount: number;\n  term: number;\n  status: 'pending' | 'approved' | 'rejected' | 'reviewing';\n  applicantName: string;\n  email: string;\n  phone: string;\n  monthlyIncome: number;\n  employmentStatus: string;\n  dateApplied: string;\n  documents: string[];\n}\n\nexport interface LoanCalculation {\n  loanAmount: number;\n  interestRate: number;\n  termMonths: number;\n  monthlyPayment: number;\n  totalPayment: number;\n  totalInterest: number;\n}\n","size_bytes":783},"backend/src/index.ts":{"content":"import express from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport morgan from 'morgan';\nimport rateLimit from 'express-rate-limit';\nimport { config } from './config';\nimport { errorHandler, notFound } from './middleware/errorHandler';\nimport authRoutes from './routes/auth';\nimport loanRoutes from './routes/loans';\nimport adminRoutes from './routes/admin';\nimport riderRoutes from './routes/rider';\n\nconst app = express();\n\nconst limiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 100,\n  message: 'Too many requests from this IP, please try again later.'\n});\n\napp.use(helmet());\napp.use(cors({\n  origin: config.frontendUrl,\n  credentials: true\n}));\napp.use(morgan('dev'));\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\napp.use('/api/', limiter);\n\napp.get('/health', (_req, res) => {\n  res.status(200).json({\n    status: 'ok',\n    timestamp: new Date().toISOString(),\n    environment: config.nodeEnv\n  });\n});\n\napp.get('/api', (_req, res) => {\n  res.json({\n    message: 'QuickLoan API',\n    version: '1.0.0',\n    endpoints: {\n      health: '/health',\n      auth: '/api/auth',\n      users: '/api/users',\n      loans: '/api/loans',\n      admin: '/api/admin',\n      rider: '/api/rider',\n      notifications: '/api/notifications'\n    }\n  });\n});\n\napp.use('/api/auth', authRoutes);\napp.use('/api/loans', loanRoutes);\napp.use('/api/admin', adminRoutes);\napp.use('/api/rider', riderRoutes);\n\napp.use(notFound);\napp.use(errorHandler);\n\nconst PORT = typeof config.port === 'string' ? parseInt(config.port) : config.port;\nconst HOST = 'localhost';\n\napp.listen(PORT, HOST, () => {\n  console.log(`🚀 Server running on ${HOST}:${PORT}`);\n  console.log(`📝 Environment: ${config.nodeEnv}`);\n  console.log(`🔒 CORS enabled for: ${config.frontendUrl}`);\n});\n\nexport default app;\n","size_bytes":1829}},"version":2}